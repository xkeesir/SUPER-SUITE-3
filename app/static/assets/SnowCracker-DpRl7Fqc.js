import{c as o,a as e,o as a,r as n,b as c,u as p,w as $,d as m,e as D,f as M,v as S,g as h,F as P,h as j,t as v,n as E,i as F,T as B,j as H}from"./index-BMAfNkhs.js";import{r as L,a as N}from"./CommandLineIcon-DF7INcJ4.js";function A(w,i){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})])}function V(w,i){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})])}const I={class:"h-full flex flex-col lg:flex-row gap-6"},z={class:"lg:w-1/3 flex flex-col gap-4"},O={class:"bg-cyber-panel border border-slate-700 rounded-xl p-6 shadow-xl relative overflow-hidden group"},R={class:"text-xl font-bold text-white mb-6 flex items-center gap-2"},U={class:"relative"},q={class:"relative"},K={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},W=["disabled"],X={key:0,class:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"},Z={key:1},G={class:"flex-1 flex flex-col gap-4 min-w-0"},J={class:"flex-1 bg-black border border-slate-700 rounded-xl shadow-2xl flex flex-col overflow-hidden font-mono text-sm relative"},Q={class:"bg-slate-800 px-4 py-2 flex items-center justify-between border-b border-slate-700"},Y={class:"text-xs text-slate-400 flex items-center gap-2"},ee={key:0,class:"text-slate-600 italic"},te={class:"text-slate-500 mr-2"},se=["innerHTML"],le={key:0,class:"bg-cyber-panel border-l-4 border-cyber-success rounded-r-xl p-6 shadow-lg flex flex-col md:flex-row gap-6 items-start md:items-center"},re={class:"bg-cyber-success/10 p-4 rounded-full shrink-0"},oe={class:"flex-1 w-full min-w-0"},ae={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ne={class:"bg-slate-800/50 p-3 rounded border border-slate-700"},ie={class:"flex items-center justify-between"},de={class:"text-cyber-primary font-mono font-bold"},ce={class:"md:col-span-2 bg-slate-800/50 p-3 rounded border border-slate-700"},ue={class:"font-mono text-slate-200 text-sm whitespace-pre-wrap break-all h-20 overflow-y-auto"},be={__name:"SnowCracker",setup(w){const i=n(null),u=n(null),g=n("flag"),b=n(!1),f=n([]),d=n(null),x=n(null),y=(l,t)=>{const s=l.target.files[0];t==="target"?i.value=s:u.value=s},r=(l,t="info")=>{const s=new Date().toLocaleTimeString("en-US",{hour12:!1});f.value.push({time:s,msg:l,type:t}),H(()=>{x.value&&(x.value.scrollTop=x.value.scrollHeight)})},k=l=>{switch(l){case"error":return"text-cyber-danger";case"success":return"text-cyber-success font-bold";case"warn":return"text-yellow-400";case"cmd":return"text-blue-400";default:return"text-slate-300"}},_=l=>{navigator.clipboard.writeText(l),r("Password copied to clipboard.","warn")},C=async()=>{if(!i.value){r("Error: No target file selected.","error");return}b.value=!0,d.value=null,f.value=[],r(`System initialized. Target: ${i.value.name}`,"system"),r(`Dictionary: ${u.value?u.value.name:"Built-in (Default)"}`,"system"),r("Connecting to backend server...","cmd");const l=new FormData;l.append("file",i.value),u.value&&l.append("custom_dict",u.value),l.append("keyword",g.value);try{const t=await fetch("/api/crack",{method:"POST",body:l});if(!t.ok)throw new Error(`HTTP Error: ${t.status}`);const s=await t.json();s.status==="success"?(r("Password found in dictionary!","success"),r(`Payload extracted: ${s.content.substring(0,50)}...`,"info"),d.value=s):(r("Process completed. Password not found.","warn"),r(`Server Message: ${s.message}`,"error"))}catch(t){r(`Network Error: ${t.message}`,"error"),r("Ensure the Docker container is running and port 8000 is mapped.","warn")}finally{b.value=!1}};return(l,t)=>(a(),o("div",I,[e("div",z,[e("div",O,[t[10]||(t[10]=e("div",{class:"absolute -top-10 -right-10 w-32 h-32 bg-cyber-primary/10 rounded-full blur-3xl group-hover:bg-cyber-primary/20 transition-all"},null,-1)),e("h2",R,[c(p(A),{class:"w-6 h-6 text-cyber-primary"}),t[5]||(t[5]=e("span",null,"å‚æ•°é…ç½®",-1))]),e("form",{onSubmit:$(C,["prevent"]),class:"space-y-5"},[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2"},"ç›®æ ‡æ–‡ä»¶ (Target)",-1)),e("div",U,[e("input",{type:"file",onChange:t[0]||(t[0]=s=>y(s,"target")),class:"block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-xs file:font-semibold file:bg-cyber-primary file:text-cyber-bg hover:file:bg-cyan-300 cursor-pointer bg-slate-800/50 rounded-lg border border-slate-700 focus:border-cyber-primary transition-colors",required:""},null,32)])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2"},[m(" å­—å…¸æ–‡ä»¶ (Dictionary) "),e("span",{class:"text-[10px] text-slate-500 normal-case ml-1"},"Optional")],-1)),e("input",{type:"file",onChange:t[1]||(t[1]=s=>y(s,"dict")),class:"block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-xs file:font-semibold file:bg-slate-600 file:text-white hover:file:bg-slate-500 cursor-pointer bg-slate-800/50 rounded-lg border border-slate-700"},null,32),t[8]||(t[8]=e("p",{class:"mt-1 text-[10px] text-slate-500"},"ç•™ç©ºåˆ™ä½¿ç”¨æœåŠ¡å™¨å†…ç½®å¼±å£ä»¤å­—å…¸ã€‚",-1))]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2"},"æˆåŠŸåˆ¤æ® (Keyword)",-1)),e("div",q,[e("div",K,[c(p(M),{class:"h-4 w-4 text-slate-500"})]),D(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>g.value=s),type:"text",class:"w-full pl-10 pr-3 py-2 bg-slate-800/50 border border-slate-700 rounded-lg focus:ring-1 focus:ring-cyber-primary focus:border-cyber-primary text-white placeholder-slate-600 sm:text-sm transition-all",placeholder:"ä¾‹å¦‚: flag, ctf"},null,512),[[S,g.value]])])]),e("button",{type:"submit",disabled:b.value,class:"w-full mt-4 flex justify-center items-center gap-2 py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-cyber-bg bg-gradient-to-r from-cyber-primary to-blue-500 hover:from-cyan-300 hover:to-blue-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyber-primary disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-[1.02]"},[b.value?(a(),o("span",X)):(a(),o("span",Z,"ðŸš€ åˆå§‹åŒ–çˆ†ç ´ç¨‹åº"))],8,W)],32)]),t[11]||(t[11]=e("div",{class:"bg-cyber-panel/50 border border-slate-800 rounded-xl p-4 text-xs text-slate-500 leading-relaxed"},[e("p",null,[e("strong",{class:"text-slate-300"},"åŽŸç†è¯´æ˜Žï¼š"),m(" åŸºäºŽ "),e("code",{class:"bg-slate-700 px-1 rounded text-cyber-primary"},"stegsnow"),m(" æ ¸å¿ƒã€‚è¯¥å·¥å…·åˆ©ç”¨ ASCII æ–‡æœ¬è¡Œå°¾çš„ç©ºæ ¼ä¸Žåˆ¶è¡¨ç¬¦è¿›è¡Œéšå†™ã€‚è¯·ç¡®ä¿ä¸Šä¼ çš„ TXT æ–‡ä»¶æœªè¢«æ ¼å¼åŒ–å·¥å…·ï¼ˆå¦‚ IDE çš„è‡ªåŠ¨ä¿å­˜ï¼‰ä¿®æ”¹ã€‚")])],-1))]),e("div",G,[e("div",J,[e("div",Q,[t[13]||(t[13]=e("div",{class:"flex gap-2"},[e("div",{class:"w-3 h-3 rounded-full bg-red-500"}),e("div",{class:"w-3 h-3 rounded-full bg-yellow-500"}),e("div",{class:"w-3 h-3 rounded-full bg-green-500"})],-1)),e("div",Y,[c(p(L),{class:"w-3 h-3"}),t[12]||(t[12]=m(" root@ctf-suite:~ ",-1))]),e("button",{onClick:t[3]||(t[3]=s=>f.value=[]),class:"text-xs text-slate-500 hover:text-white transition-colors"},"Clear")]),e("div",{class:"flex-1 p-4 overflow-y-auto space-y-1 scrollbar-hide",ref_key:"terminalRef",ref:x},[f.value.length===0?(a(),o("div",ee,"Waiting for input...")):h("",!0),(a(!0),o(P,null,j(f.value,(s,T)=>(a(),o("div",{key:T,class:"break-all"},[e("span",te,"["+v(s.time)+"]",1),e("span",{class:E(k(s.type)),innerHTML:s.msg},null,10,se)]))),128))],512)]),c(B,{name:"fade"},{default:F(()=>[d.value?(a(),o("div",le,[e("div",re,[c(p(V),{class:"w-10 h-10 text-cyber-success"})]),e("div",oe,[t[16]||(t[16]=e("h3",{class:"text-lg font-bold text-white mb-1"},"Cracking Successful!",-1)),t[17]||(t[17]=e("p",{class:"text-slate-400 text-xs mb-4"},"éšå†™ä¿¡æ¯å·²æˆåŠŸæå–ã€‚",-1)),e("div",ae,[e("div",ne,[t[14]||(t[14]=e("label",{class:"text-[10px] uppercase text-slate-500 font-bold"},"Password",-1)),e("div",ie,[e("span",de,v(d.value.password),1),e("button",{onClick:t[4]||(t[4]=s=>_(d.value.password)),class:"text-slate-400 hover:text-white"},[c(p(N),{class:"w-4 h-4"})])])]),e("div",ce,[t[15]||(t[15]=e("label",{class:"text-[10px] uppercase text-slate-500 font-bold"},"Decrypted Content",-1)),e("div",ue,v(d.value.content),1)])])])])):h("",!0)]),_:1})])]))}};export{be as default};
