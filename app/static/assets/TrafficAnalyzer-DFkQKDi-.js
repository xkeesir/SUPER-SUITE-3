import{c as l,a as e,o,_ as z,r as d,b as f,d as _,u as b,e as k,v as A,A as C,t as i,F as D,h as H,n as h,g as M}from"./index-Cbgz85v2.js";import{r as $}from"./LockOpenIcon-FCm7jxyW.js";function E(v,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"})])}function R(v,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243-1.59-1.59"})])}function Z(v,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])}function N(v,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})])}const O={class:"h-full flex flex-col gap-4"},U={class:"bg-cyber-panel border border-slate-700 rounded-xl p-4 shadow-lg flex flex-wrap gap-4 items-center justify-between"},F={class:"flex items-center gap-4"},L={class:"relative group"},I={class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg transition-all font-bold text-sm shadow-blue-900/50 shadow-lg"},G={class:"flex items-center gap-2"},K={class:"text-slate-500 text-xs font-mono"},q={key:0},J={key:1},X={class:"flex-1 flex gap-4 min-h-0"},Q={class:"w-1/3 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-xl"},W={class:"bg-slate-800/80 px-4 py-2 border-b border-slate-700 flex justify-between items-center backdrop-blur-sm"},Y={class:"font-bold text-slate-200 text-sm flex items-center gap-2"},ee={class:"flex-1 overflow-auto custom-scrollbar"},te={key:0,class:"flex flex-col items-center justify-center h-full gap-4"},se={key:1,class:"w-full text-left text-xs font-mono"},le={class:"divide-y divide-slate-800"},oe=["onClick"],ae={class:"px-3 py-2 text-slate-400"},re={class:"px-3 py-2"},ne=["title"],de={class:"px-3 py-2"},ie={key:0,class:"px-1.5 py-0.5 rounded bg-red-900/50 text-red-400 border border-red-800/50 text-[10px] font-bold"},ce={key:1,class:"text-slate-600"},ue={class:"flex-1 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-xl relative"},pe={key:0,class:"absolute inset-0 flex items-center justify-center flex-col gap-4 opacity-50"},xe={key:1,class:"flex flex-col h-full"},fe={class:"bg-slate-800/80 px-6 py-3 border-b border-slate-700 flex justify-between items-center"},be={class:"flex items-center gap-4"},ve={class:"text-lg font-bold text-white"},he={class:"text-xs text-slate-400 font-mono bg-slate-900 px-2 py-1 rounded"},ye={class:"flex-1 flex flex-col min-h-0 bg-[#0d1117]"},ge={class:"flex border-b border-slate-700 bg-slate-900/50"},me={class:"flex-1 overflow-auto p-4 custom-scrollbar"},we={key:0,class:"font-mono text-xs leading-relaxed"},_e={class:"mb-4"},ke={class:"text-slate-300 bg-slate-800/50 p-4 rounded border border-slate-700 whitespace-pre-wrap break-all"},Ce={key:1,class:"h-full flex flex-col"},Me={key:0,class:"flex-1 flex items-center justify-center"},je={key:1,class:"h-full flex flex-col"},Se={key:0,class:"h-full flex flex-col gap-2"},Te=["value"],Pe={key:1,class:"flex-1 flex items-center justify-center text-slate-600 flex-col gap-2"},Be={__name:"TrafficAnalyzer",setup(v){const n=d([]),r=d(null),y=d(!1),g=d(!1),c=d("raw"),u=d(""),m=d("rebeyond"),p=d("behinder"),w=d("aes_ecb"),j=async a=>{const t=a.target.files[0];if(!t)return;y.value=!0,n.value=[],r.value=null;const s=new FormData;s.append("file",t);try{const x=await fetch("/api/traffic/analyze",{method:"POST",body:s});x.ok?n.value=await x.json():alert("解析失败，请检查文件格式")}catch(x){console.error(x),alert("网络错误")}finally{y.value=!1}},S=a=>{r.value=a,c.value="raw",u.value="",a.shell_type==="godzilla"&&(p.value="godzilla"),a.shell_type==="chopper"&&(p.value="chopper")},T=a=>({GET:"text-purple-400 font-bold",POST:"text-cyan-400 font-bold",RESP:"text-slate-500"})[a]||"text-slate-300",P=a=>{try{return atob(a)}catch{return"[Binary Data]"}},B=async()=>{if(r.value){c.value="decoded",g.value=!0;try{const t=await(await fetch("/api/traffic/decrypt_shell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload_b64:r.value.raw_payload,shell_type:p.value,key:m.value,mode:w.value})})).json();t.status==="success"?u.value=t.content:u.value=`[Error] ${t.content}`}catch(a){u.value=`[System Error] ${a.message}`}finally{g.value=!1}}},V=()=>{navigator.clipboard.writeText(u.value)};return(a,t)=>(o(),l("div",O,[e("div",U,[e("div",F,[e("div",L,[e("button",I,[f(b(E),{class:"w-5 h-5"}),t[5]||(t[5]=_(" 上传 PCAP 文件 ",-1))]),e("input",{type:"file",accept:".pcap,.pcapng",onChange:j,class:"absolute inset-0 opacity-0 cursor-pointer"},null,32)]),t[9]||(t[9]=e("div",{class:"h-8 w-[1px] bg-slate-700 mx-2"},null,-1)),e("div",G,[t[8]||(t[8]=e("span",{class:"text-slate-400 text-xs uppercase font-bold tracking-wider"},"解密设置",-1)),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),type:"text",placeholder:"Shell Password / Key",class:"bg-slate-800 border border-slate-600 text-white text-sm rounded px-3 py-1.5 focus:border-blue-500 outline-none w-40 placeholder-slate-600 font-mono"},null,512),[[A,m.value]]),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),class:"bg-slate-800 border border-slate-600 text-white text-sm rounded px-3 py-1.5 focus:border-blue-500 outline-none"},[...t[6]||(t[6]=[e("option",{value:"godzilla"},"哥斯拉 (Godzilla)",-1),e("option",{value:"behinder"},"冰蝎 (Behinder)",-1),e("option",{value:"chopper"},"菜刀 (Chopper)",-1)])],512),[[C,p.value]]),k(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>w.value=s),class:"bg-slate-800 border border-slate-600 text-white text-sm rounded px-3 py-1.5 focus:border-blue-500 outline-none"},[...t[7]||(t[7]=[e("option",{value:"aes_ecb"},"AES (ECB/Default)",-1),e("option",{value:"aes_cbc"},"AES (CBC)",-1),e("option",{value:"xor"},"XOR",-1)])],512),[[C,w.value]])])]),e("div",K,[n.value.length?(o(),l("span",q,"Loaded "+i(n.value.length)+" packets",1)):(o(),l("span",J,"No Capture File"))])]),e("div",X,[e("div",Q,[e("div",W,[e("span",Y,[f(b(Z),{class:"w-4 h-4 text-cyan-400"}),t[10]||(t[10]=_(" 流量列表 ",-1))])]),e("div",ee,[y.value?(o(),l("div",te,[...t[11]||(t[11]=[e("div",{class:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"text-xs text-blue-400 animate-pulse"},"正在解析 PCAP...",-1)])])):(o(),l("table",se,[t[12]||(t[12]=e("thead",{class:"bg-slate-900 sticky top-0 z-10 text-slate-500"},[e("tr",null,[e("th",{class:"px-3 py-2"},"ID"),e("th",{class:"px-3 py-2"},"Method"),e("th",{class:"px-3 py-2"},"URI"),e("th",{class:"px-3 py-2"},"Type")])],-1)),e("tbody",le,[(o(!0),l(D,null,H(n.value,s=>(o(),l("tr",{key:s.id,onClick:x=>S(s),class:h(["cursor-pointer hover:bg-blue-900/20 transition-colors",r.value?.id===s.id?"bg-blue-900/40 border-l-2 border-blue-500":"border-l-2 border-transparent"])},[e("td",ae,i(s.id),1),e("td",re,[e("span",{class:h(T(s.method))},i(s.method),3)]),e("td",{class:"px-3 py-2 text-slate-300 truncate max-w-[150px]",title:s.uri},i(s.uri),9,ne),e("td",de,[s.shell_type!=="unknown"?(o(),l("span",ie,i(s.shell_type.toUpperCase()),1)):(o(),l("span",ce,"-"))])],10,oe))),128))])]))])]),e("div",ue,[r.value?(o(),l("div",xe,[e("div",fe,[e("div",be,[e("span",ve,i(r.value.method)+" Request",1),e("span",he,i(r.value.src)+" → "+i(r.value.dst),1)]),e("button",{onClick:B,class:"flex items-center gap-2 bg-green-600/20 hover:bg-green-600/30 text-green-400 border border-green-600/50 px-3 py-1.5 rounded text-xs transition-all active:scale-95"},[f(b($),{class:"w-4 h-4"}),t[14]||(t[14]=_(" 尝试解密 payload ",-1))])]),e("div",ye,[e("div",ge,[e("button",{onClick:t[3]||(t[3]=s=>c.value="raw"),class:h(["px-4 py-2 text-xs font-bold transition-colors",c.value==="raw"?"text-blue-400 border-b-2 border-blue-400 bg-blue-900/10":"text-slate-500 hover:text-slate-300"])}," Raw / Hex ",2),e("button",{onClick:t[4]||(t[4]=s=>c.value="decoded"),class:h(["px-4 py-2 text-xs font-bold transition-colors",c.value==="decoded"?"text-green-400 border-b-2 border-green-400 bg-green-900/10":"text-slate-500 hover:text-slate-300"])}," Decrypted Output ",2)]),e("div",me,[c.value==="raw"?(o(),l("div",we,[e("div",_e,[t[15]||(t[15]=e("h4",{class:"text-slate-500 mb-2"},"HTTP Header & Body Preview:",-1)),e("pre",ke,i(P(r.value.raw_payload)),1)])])):M("",!0),c.value==="decoded"?(o(),l("div",Ce,[g.value?(o(),l("div",Me,[...t[16]||(t[16]=[e("div",{class:"animate-spin w-8 h-8 border-2 border-green-500 border-t-transparent rounded-full"},null,-1)])])):(o(),l("div",je,[u.value?(o(),l("div",Se,[e("div",{class:"flex justify-between items-center"},[t[17]||(t[17]=e("span",{class:"text-green-400 text-xs font-bold"},"Success",-1)),e("button",{onClick:V,class:"text-xs text-slate-500 hover:text-white"},"Copy")]),e("textarea",{readonly:"",class:"flex-1 w-full bg-slate-800 text-green-300 font-mono text-xs p-4 rounded border border-slate-700 focus:outline-none resize-none",value:u.value},null,8,Te)])):(o(),l("div",Pe,[f(b(N),{class:"w-10 h-10 opacity-20"}),t[18]||(t[18]=e("p",null,"尚未解密或解密失败",-1)),t[19]||(t[19]=e("p",{class:"text-[10px]"},'请检查密钥和加密模式，然后点击右上角"尝试解密"',-1))]))]))])):M("",!0)])])])):(o(),l("div",pe,[f(b(R),{class:"w-16 h-16 text-slate-600"}),t[13]||(t[13]=e("p",{class:"text-slate-500 font-mono"},"Select a packet to inspect payload",-1))]))])])]))}},Ae=z(Be,[["__scopeId","data-v-adf70622"]]);export{Ae as default};
