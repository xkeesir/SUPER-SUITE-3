import{c as p,a as t,o as i,r as a,k as C,p as U,e as c,d as m,v as u,n as T,q as j,t as J,s as I,u as w,b as B,g as F}from"./index-CHdk52Yy.js";import{C as d}from"./index-CbxcYopB.js";import"./_commonjsHelpers-DsqdWQfm.js";function W(x,s){return i(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function Y(x,s){return i(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z","clip-rule":"evenodd"})])}function P(x,s){return i(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M12.963 2.286a.75.75 0 0 0-1.071-.136 9.742 9.742 0 0 0-3.539 6.176 7.547 7.547 0 0 1-1.705-1.715.75.75 0 0 0-1.152-.082A9 9 0 1 0 15.68 4.534a7.46 7.46 0 0 1-2.717-2.248ZM15.75 14.25a3.75 3.75 0 1 1-7.313-1.172c.628.465 1.35.81 2.133 1a5.99 5.99 0 0 1 1.925-3.546 3.75 3.75 0 0 1 3.255 3.718Z","clip-rule":"evenodd"})])}function E(x,s){return i(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M15.75 1.5a6.75 6.75 0 0 0-6.651 7.906c.067.39-.032.717-.221.906l-6.5 6.499a3 3 0 0 0-.878 2.121v2.818c0 .414.336.75.75.75H6a.75.75 0 0 0 .75-.75v-1.5h1.5A.75.75 0 0 0 9 19.5V18h1.5a.75.75 0 0 0 .53-.22l2.658-2.658c.19-.189.517-.288.906-.22A6.75 6.75 0 1 0 15.75 1.5Zm0 3a.75.75 0 0 0 0 1.5A2.25 2.25 0 0 1 18 8.25a.75.75 0 0 0 1.5 0 3.75 3.75 0 0 0-3.75-3.75Z","clip-rule":"evenodd"})])}function R(x,s){return i(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z","clip-rule":"evenodd"})])}const q={class:"h-full flex flex-col xl:flex-row gap-6 overflow-hidden"},G={class:"xl:w-1/4 flex flex-col gap-4 min-w-[300px]"},K={class:"bg-cyber-panel border border-slate-700 rounded-xl p-4 flex flex-col flex-1 shadow-lg"},Q={class:"flex flex-col"},X={class:"text-xs font-bold text-white"},ee={class:"flex-1 flex flex-col gap-4 overflow-y-auto pr-1"},te={class:"bg-cyber-panel border-l-4 border-red-500 rounded-r-xl shadow-lg"},le={class:"bg-cyber-panel border-l-4 border-purple-500 rounded-r-xl shadow-lg flex-1 min-h-[200px]"},re={class:"bg-slate-800 border border-slate-700 rounded-xl p-4 flex flex-col gap-3"},se={class:"text-xs font-bold text-orange-400 flex items-center gap-2"},oe={class:"grid grid-cols-2 gap-4"},ae={class:"xl:w-1/4 flex flex-col gap-4 min-w-[300px]"},ne={class:"bg-cyber-panel border border-slate-700 rounded-xl p-4 shadow-lg"},de={class:"relative"},ie={class:"bg-cyber-panel border border-slate-700 rounded-xl p-4 flex-1 flex flex-col shadow-lg"},ce={class:"text-xs font-bold text-cyber-primary uppercase block mb-2 flex justify-between"},ue=["value"],pe={class:"bg-cyber-danger/5 border border-cyber-danger/30 rounded-xl p-4"},xe={class:"flex justify-between items-center mb-2"},be={class:"text-xs font-bold text-cyber-danger flex items-center gap-2"},fe={class:"cursor-pointer text-[10px] bg-slate-800 border border-slate-600 px-2 py-1 rounded text-slate-300 hover:text-white transition"},ge=["disabled"],ve={key:0,class:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full"},Se={__name:"JwtTool",setup(x){const s=a(""),b=a(`{
  "alg": "HS256",
  "typ": "JWT"
}`),f=a(`{
  "sub": "1234567890",
  "name": "CTF Player",
  "iat": 1516239022
}`),g=a("secret"),N=a("复制"),O=l=>{const e=d.enc.Utf8.parse(l);return d.enc.Base64.stringify(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},D=l=>{const e=l.replace(/-/g,"+").replace(/_/g,"/");try{return decodeURIComponent(window.atob(e).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join(""))}catch{return""}};C(s,l=>{if(!l)return;const e=l.split(".");if(e.length===3)try{const r=JSON.parse(D(e[0])),n=JSON.parse(D(e[1]));b.value=JSON.stringify(r,null,2),f.value=JSON.stringify(n,null,2)}catch(r){console.error(r)}});const V=U(()=>{try{JSON.parse(b.value),JSON.parse(f.value);const l=O(JSON.stringify(JSON.parse(b.value))),e=O(JSON.stringify(JSON.parse(f.value))),r=d.HmacSHA256(l+"."+e,g.value),n=d.enc.Base64.stringify(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return`${l}.${e}.${n}`}catch{return"Invalid JSON Structure"}}),v=U(()=>{if(!s.value||s.value.split(".").length!==3)return!1;const l=s.value.split("."),e=l[0]+"."+l[1],r=l[2],n=d.HmacSHA256(e,g.value),o=d.enc.Base64.stringify(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return r===o}),H=()=>{navigator.clipboard.writeText(V.value),N.value="已复制!",setTimeout(()=>N.value="复制",1500)},y=a(Math.floor(Date.now()/1e3)),h=a(new Date().toLocaleString("zh-CN",{hour12:!1})),z=l=>{const e=parseInt(l);return isNaN(e)||e<0?"":new Date(e*1e3).toLocaleString("zh-CN",{hour12:!1})},A=l=>{const e=new Date(l);return isNaN(e.getTime())?"":Math.floor(e.getTime()/1e3)};C(y,l=>{l&&(h.value=z(l))}),C(h,l=>{l&&(y.value=A(l))});const S=a(`123456
password
secret
admin
rockyou
ctf`),_=a(!1),k=a("Start Crack"),Z=l=>{const e=l.target.files[0];if(!e)return;const r=new FileReader;r.onload=n=>S.value=n.target.result,r.readAsText(e)},$=()=>{const l=s.value.split(".");if(l.length!==3){alert("无效的JWT");return}_.value=!0,k.value="正在爆破...";const e=l[2],r=l[0]+"."+l[1],n=S.value.split(`
`).map(o=>o.trim()).filter(o=>o);setTimeout(()=>{let o=null;for(let M of n){const L=d.HmacSHA256(r,M);if(d.enc.Base64.stringify(L).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")===e){o=M;break}}o?(g.value=o,alert(`Success! Secret found: ${o}`)):alert("Failed. Secret not in dictionary."),_.value=!1,k.value="开始爆破"},100)};return(l,e)=>(i(),p("div",q,[t("div",G,[t("div",K,[e[7]||(e[7]=t("h3",{class:"text-white font-bold mb-4 flex items-center gap-2"},[t("span",{class:"bg-cyber-primary text-cyber-bg px-2 py-0.5 rounded text-xs font-extrabold"},"JWT"),m(" 输入 ")],-1)),c(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.value=r),class:"flex-1 w-full bg-slate-900 border border-slate-700 rounded-lg p-3 font-mono text-xs text-slate-400 focus:text-white focus:border-cyber-primary outline-none resize-none break-all",placeholder:"Paste JWT here..."},null,512),[[u,s.value]]),t("div",{class:T(["mt-4 p-3 rounded-lg border flex items-center justify-between",v.value?"bg-cyber-success/10 border-cyber-success/30":"bg-cyber-danger/10 border-cyber-danger/30"])},[t("div",Q,[t("span",{class:T(["text-[10px] font-bold tracking-wider opacity-70",v.value?"text-cyber-success":"text-cyber-danger"])}," 签名 ",2),t("span",X,J(v.value?"有效！":"无效！"),1)]),(i(),j(I(v.value?w(W):w(R)),{class:T(["w-6 h-6",v.value?"text-cyber-success":"text-cyber-danger"])},null,8,["class"]))],2)])]),t("div",ee,[t("div",te,[e[8]||(e[8]=t("div",{class:"p-2 bg-slate-800/50 border-b border-slate-700 text-xs font-bold text-red-400 uppercase"},"Header",-1)),c(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=r=>b.value=r),class:"w-full h-32 bg-transparent p-3 font-mono text-sm text-slate-300 outline-none resize-none"},null,512),[[u,b.value]])]),t("div",le,[e[9]||(e[9]=t("div",{class:"p-2 bg-slate-800/50 border-b border-slate-700 text-xs font-bold text-purple-400 uppercase"},"Payload",-1)),c(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=r=>f.value=r),class:"w-full h-full bg-transparent p-3 font-mono text-sm text-slate-300 outline-none resize-none"},null,512),[[u,f.value]])]),t("div",re,[t("h4",se,[B(w(Y),{class:"w-4 h-4"}),e[10]||(e[10]=m(" 时间戳转换 ",-1))]),t("div",oe,[t("div",null,[c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>y.value=r),type:"number",class:"w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-xs font-mono text-white focus:border-orange-400 outline-none",placeholder:"Unix Sec"},null,512),[[u,y.value,void 0,{lazy:!0}]]),e[11]||(e[11]=t("p",{class:"text-[10px] text-slate-500 mt-1"},"时间戳",-1))]),t("div",null,[c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>h.value=r),type:"text",class:"w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-xs font-mono text-white focus:border-orange-400 outline-none",placeholder:"YYYY/MM/DD HH:mm:ss"},null,512),[[u,h.value,void 0,{lazy:!0}]]),e[12]||(e[12]=t("p",{class:"text-[10px] text-slate-500 mt-1"},"可读时间",-1))])])])]),t("div",ae,[t("div",ne,[e[13]||(e[13]=t("label",{class:"text-xs font-bold text-blue-400 uppercase block mb-2"},"密钥",-1)),t("div",de,[c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>g.value=r),type:"text",class:"w-full bg-slate-900 border border-slate-600 rounded-lg pl-3 pr-10 py-2 text-sm text-white font-mono focus:border-blue-400 outline-none"},null,512),[[u,g.value]]),B(w(E),{class:"w-4 h-4 text-slate-500 absolute right-3 top-2.5"})])]),t("div",ie,[t("label",ce,[e[14]||(e[14]=t("span",null,"输出",-1)),t("button",{onClick:H,class:"text-[10px] bg-slate-700 px-2 rounded hover:bg-slate-600 transition"},J(N.value),1)]),t("textarea",{readonly:"",value:V.value,class:"flex-1 w-full bg-slate-900 border border-slate-700 rounded-lg p-3 font-mono text-xs text-cyber-primary break-all resize-none outline-none focus:ring-1 focus:ring-cyber-primary"},null,8,ue)]),t("div",pe,[t("div",xe,[t("h4",be,[B(w(P),{class:"w-4 h-4"}),e[15]||(e[15]=m(" 密钥爆破 ",-1))]),t("label",fe,[e[16]||(e[16]=m(" 载入字典 ",-1)),t("input",{type:"file",onChange:Z,class:"hidden",accept:".txt"},null,32)])]),c(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=r=>S.value=r),rows:"4",class:"w-full bg-slate-900 border border-cyber-danger/30 rounded p-2 text-[10px] font-mono text-slate-400 focus:text-white mb-2 resize-none",placeholder:"password list..."},null,512),[[u,S.value]]),t("button",{onClick:$,disabled:_.value||!s.value,class:"w-full bg-cyber-danger text-white py-2 rounded text-xs font-bold hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition flex justify-center items-center gap-2"},[_.value?(i(),p("span",ve)):F("",!0),m(" "+J(k.value),1)],8,ge)])])]))}};export{Se as default};
