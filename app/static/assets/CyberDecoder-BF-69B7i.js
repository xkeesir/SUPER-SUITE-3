import{_ as _export_sfc,r as ref,k as watch,c as createElementBlock,a as createBaseVNode,e as withDirectives,b as createVNode,u as unref,l as render,v as vModelText,g as createCommentVNode,t as toDisplayString,i as withCtx,d as createTextVNode,F as Fragment,h as renderList,m as TransitionGroup,o as openBlock}from"./index-CI3-vDyV.js";import{C as CryptoJS}from"./index-CbxcYopB.js";import{r as render$1}from"./SparklesIcon-D_KrWZAU.js";import{r as render$2}from"./CpuChipIcon-rwxBat_i.js";import"./_commonjsHelpers-DsqdWQfm.js";const _hoisted_1={class:"h-full flex flex-col md:flex-row gap-6"},_hoisted_2={class:"flex-1 flex flex-col min-h-[300px]"},_hoisted_3={class:"bg-cyber-panel border border-slate-700 rounded-t-xl p-3 flex justify-between items-center"},_hoisted_4={class:"text-white font-bold flex items-center gap-2"},_hoisted_5={class:"flex-[1.5] flex flex-col min-h-0 bg-cyber-panel border border-slate-700 rounded-xl shadow-xl overflow-hidden"},_hoisted_6={class:"bg-slate-800/50 p-4 border-b border-slate-700 flex justify-between items-center"},_hoisted_7={class:"text-white font-bold flex items-center gap-2"},_hoisted_8={key:0,class:"text-xs text-cyber-primary bg-cyber-primary/10 px-2 py-1 rounded-full"},_hoisted_9={class:"flex-1 overflow-y-auto p-4 space-y-4 relative scrollbar-thin"},_hoisted_10={key:0,class:"absolute inset-0 flex flex-col items-center justify-center text-slate-600 pointer-events-none"},_hoisted_11={key:"recursive",class:"bg-slate-800/80 border border-cyber-success/30 rounded-lg overflow-hidden relative shadow-lg shadow-green-900/20"},_hoisted_12={class:"p-3 border-b border-slate-700/50 flex justify-between items-center bg-cyber-success/5"},_hoisted_13={class:"px-3 py-1.5 bg-black/20 text-[10px] font-mono flex flex-wrap gap-1 items-center border-b border-slate-700/30"},_hoisted_14={class:"text-blue-400 font-bold"},_hoisted_15={key:0,class:"text-slate-600"},_hoisted_16={class:"p-3 max-h-60 overflow-y-auto"},_hoisted_17={class:"text-sm font-mono text-slate-200 whitespace-pre-wrap break-all"},_hoisted_18={class:"px-3 py-2 bg-slate-900/50 border-b border-slate-700 flex justify-between items-center"},_hoisted_19={class:"text-xs font-bold text-cyber-primary"},_hoisted_20=["onClick"],_hoisted_21={class:"p-3"},_hoisted_22={class:"text-xs sm:text-sm font-mono text-slate-300 whitespace-pre-wrap break-all"},MAX_BIGINT_LEN=15e3,_sfc_main={__name:"CyberDecoder",setup(__props){const inputText=ref(""),results=ref([]),recursiveResult=ref(null);let timeoutId=null;const aaDecode=text=>{if(!text||text.indexOf("(ﾟДﾟ)")===-1)return null;var evalPreamble="(ﾟДﾟ) ['_'] ( (ﾟДﾟ) ['_'] (",decodePreamble="( (ﾟДﾟ) ['_'] (",evalPostamble=") (ﾟΘﾟ)) ('_');",decodePostamble=") ());";try{const varDecl="var ﾟωﾟﾉ, ﾟΘﾟ, ﾟｰﾟ, ﾟДﾟ, ﾟДﾟﾉ, ﾟｰﾟﾉ, c, o; ";var decodingScript=text.trim().replace(evalPreamble,decodePreamble).replace(evalPostamble,decodePostamble);return eval(varDecl+decodingScript)}catch(r){return null}},jjDecode=r=>{if(!r)return null;r=r.trim();let t,s,o;if(r.indexOf("=~[")===-1||(r.indexOf(`"'\\"+'+",`)===0?(s=r.indexOf('$$+"\\""+')+8,o=r.indexOf('"\\"")())()'),t=r.substring(r.indexOf(`"'\\"+'+",`)+9,r.indexOf("=~[]"))):(t=r.substring(0,r.indexOf("=")),s=r.indexOf('"\\""+')+5,o=r.indexOf('"\\"")())()')),!t||s===-1||o===-1||s>=o))return null;let e=r.substring(s,o),l="";var n=["___+","__$+","_$_+","_$$+","$__+","$_$+","$$_+","$$$+","$___+","$__$+","$_$_+","$_$$+","$$__+","$$_$+","$$$_+","$$$$+"],c='(![]+"")['+t+"._$_]+",i=t+"._$+",a=t+".__+",d=t+"._+",u=t+".",p='"',g=t+".",F='\\\\\\"',y="\\\\\\\\",_='\\\\"+',m='\\\\"+'+t+"._+",k='"+';try{for(;e!="";){if(e.indexOf(c)==0){e=e.substr(c.length),l+="l";continue}if(e.indexOf(i)==0){e=e.substr(i.length),l+="o";continue}if(e.indexOf(a)==0){e=e.substr(a.length),l+="t";continue}if(e.indexOf(d)==0){e=e.substr(d.length),l+="u";continue}if(e.indexOf(u)==0){e=e.substr(u.length);let f=!1;for(let h=0;h<n.length;h++)if(e.indexOf(n[h])==0){e=e.substr(n[h].length),l+=h.toString(16),f=!0;break}if(f)continue}if(e.indexOf(p)==0)if(e=e.substr(p.length),e.indexOf(m)==0){e=e.substr(m.length);let f="";for(let h=0;h<2&&e.indexOf(g)==0;h++){e=e.substr(g.length);for(let x=0;x<n.length;x++)if(e.indexOf(n[x])==0){e=e.substr(n[x].length),f+=x.toString(16)+"";break}}l+=String.fromCharCode(parseInt(f,16));continue}else if(e.indexOf(_)==0){e=e.substr(_.length);let f="",h="",x="",B=0;for(let v=0;v<3;v++){if(v>1){if(e.indexOf(c)==0){e=e.substr(c.length),h="l";break}if(e.indexOf(i)==0){e=e.substr(i.length),h="o";break}if(e.indexOf(a)==0){e=e.substr(a.length),h="t";break}if(e.indexOf(d)==0){e=e.substr(d.length),h="u";break}}if(e.indexOf(g)==0){x=e.substr(g.length);for(let b=0;b<8;b++)if(x.indexOf(n[b])==0){if(parseInt(f+b+"",8)>128){B=1;break}f+=b+"",e=e.substr(g.length+n[b].length);break}if(B==1&&e.indexOf(u)==0){e=e.substr(u.length);for(let b=0;b<n.length;b++)if(e.indexOf(n[b])==0){e=e.substr(n[b].length),h=b.toString(16);break}break}}else break}l+=String.fromCharCode(parseInt(f,8))+h;continue}else{let f=0;for(;;){if(e.indexOf(F)==0){e=e.substr(F.length),l+='"',f++;continue}if(e.indexOf(y)==0){e=e.substr(y.length),l+="\\",f++;continue}if(e.indexOf(k)==0){if(f==0)return null;e=e.substr(k.length);break}if(e.indexOf(m)==0||e.indexOf(_)==0)break;if(e.length>0)l+=e.charAt(0),e=e.substr(1),f++;else break}continue}break}return l}catch{return null}},uuDecode=r=>{if(!r||r.length<2)return null;let t="",s=r.split(`
`),o=!1;for(let e of s){if(e=e.trim(),!e)continue;let l=e.charCodeAt(0);if(l<32)continue;let n=l-32&63;if(n===0)continue;let c=e.substring(1),i=[];for(let a=0;a<c.length;a+=4){let d=[0,0,0,0];for(let p=0;p<4;p++)a+p<c.length&&(d[p]=c.charCodeAt(a+p)-32&63);let u=d[0]<<18|d[1]<<12|d[2]<<6|d[3];i.push(u>>16&255,u>>8&255,u&255)}for(let a=0;a<n&&a<i.length;a++)t+=String.fromCharCode(i[a]);o=!0}return o&&t.length>0?t:null},xxDecode=r=>{const t="+-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";if(!r||r.length<2)return null;let s="",o=r.split(`
`),e=!1;for(let l of o){if(l=l.trim(),!l||l==="begin"||l==="end")continue;let n=t.indexOf(l[0]);if(n<=0)continue;let c=l.substring(1),i=[];for(let a=0;a<c.length;a+=4){let d=0;for(let u=0;u<4;u++){let p=0;if(a+u<c.length){let g=t.indexOf(c[a+u]);g>-1&&(p=g)}d=d<<6|p}i.push(d>>16&255,d>>8&255,d&255)}for(let a=0;a<n&&a<i.length;a++)s+=String.fromCharCode(i[a]);e=!0}return e&&s.length>0?s:null},brainfuck=r=>{if(!r.includes("[")||!r.includes("]")||!/^[<>+\-.,[\]\s\r\n]+$/.test(r))return null;let t=new Uint8Array(3e4),s=0,o="",e=r.replace(/[^<>+\-.,[\]]/g,""),l=[];try{for(let n=0;n<e.length&&!(o.length>5e3);n++)switch(e[n]){case">":s++;break;case"<":s--;break;case"+":t[s]++;break;case"-":t[s]--;break;case".":o+=String.fromCharCode(t[s]);break;case"[":if(t[s]===0){let c=1;for(;c>0&&(n++,!(n>=e.length));)e[n]==="["?c++:e[n]==="]"&&c--}else l.push(n);break;case"]":t[s]!==0?n=l[l.length-1]:l.pop();break}}catch{return null}return o||"Exec OK (No Output)"},genericBaseDecode=(r,t)=>{if(!r||r.length>MAX_BIGINT_LEN)return null;for(let s=0;s<r.length;s++)if(t.indexOf(r[s])===-1)return null;try{let s=0n;const o=BigInt(t.length);for(let n=0;n<r.length;n++)s=s*o+BigInt(t.indexOf(r[n]));let e=s.toString(16);e.length%2&&(e="0"+e);let l="";for(let n=0;n<e.length;n+=2)l+=String.fromCharCode(parseInt(e.substr(n,2),16));return decodeURIComponent(escape(l))}catch{return null}},base58Decode=r=>{if(!r||r.length>MAX_BIGINT_LEN)return null;const t="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";if(!new RegExp(`^[${t}]+$`).test(r))return null;try{let s=0n;const o=58n;for(let n=0;n<r.length;n++)s=s*o+BigInt(t.indexOf(r[n]));let e=s.toString(16);e.length%2&&(e="0"+e);let l="";for(let n=0;n<r.length&&r[n]==="1";n++)l+="\0";for(let n=0;n<e.length;n+=2)l+=String.fromCharCode(parseInt(e.substr(n,2),16));return l}catch{return null}},base91Decode=r=>{if(!r||r.length>5e5)return null;const t='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&()*+,./:;<=>?@[]^_`{|}~"';for(let n=0;n<r.length;n++)if(t.indexOf(r[n])===-1)return null;let s=-1,o=0,e=0,l="";try{for(let n=0;n<r.length;n++){const c=t.indexOf(r[n]);if(s<0)s=c;else{s+=c*91,o|=s<<e,e+=(s&8191)>88?13:14;do l+=String.fromCharCode(o&255),o>>=8,e-=8;while(e>7);s=-1}}return s>-1&&(l+=String.fromCharCode((o|s<<e)&255)),decodeURIComponent(escape(l))}catch{return null}},base85Decode=r=>{let t=r.trim();t.startsWith("<~")&&(t=t.substring(2)),t.endsWith("~>")&&(t=t.substring(0,t.length-2)),t=t.replace(/z/g,"!!!!!").replace(/\s/g,"");let s="",o=0,e=0;try{for(let l=0;l<t.length;l++){let n=t.charCodeAt(l);if(n<33||n>117)return null;if(o=o*85+(n-33),e++,e===5){for(let c=24;c>=0;c-=8)s+=String.fromCharCode(o>>c&255);o=0,e=0}}if(e>0){let l=5-e;for(let n=0;n<l;n++)o=o*85+84;for(let n=24;n>=0;n-=8)s+=String.fromCharCode(o>>n&255);s=s.substring(0,s.length-l)}return decodeURIComponent(escape(s))}catch{return null}},Decoders={jjDecode,aaDecode,uuDecode,xxDecode,brainfuck,base16:r=>{let t=r.replace(/\s/g,"");if(!/^[0-9a-fA-F]+$/.test(t)||t.length%2!==0)return null;let s="";for(let o=0;o<t.length;o+=2)s+=String.fromCharCode(parseInt(t.substr(o,2),16));try{return decodeURIComponent(escape(s))}catch{return s}},base32:r=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";let s="",o="",e=r.replace(/\s/g,"").replace(/=+$/,"").toUpperCase();if(!/^[A-Z2-7]+$/.test(e))return null;try{for(let l=0;l<e.length;l++){let n=t.indexOf(e[l]);if(n===-1)return null;s+=n.toString(2).padStart(5,"0")}for(let l=0;l<s.length&&!(l+8>s.length);l+=8)o+=String.fromCharCode(parseInt(s.substr(l,8),2));return decodeURIComponent(escape(o))}catch{return o}},base64:r=>{try{return/^[A-Za-z0-9+/=\s]+$/.test(r)?decodeURIComponent(escape(atob(r.replace(/\s/g,"")))):null}catch{return null}},base36:r=>genericBaseDecode(r,"0123456789abcdefghijklmnopqrstuvwxyz"),base58:r=>base58Decode(r),base62:r=>genericBaseDecode(r,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"),base85:r=>base85Decode(r),base91:r=>base91Decode(r),buddhaDecode:r=>{if(!r.includes("佛曰："))return null;try{let t=r.replace(/^佛曰：/,""),s=CryptoJS.enc.Utf8.parse("Script"),o=CryptoJS.enc.Base64.parse("OTg3NjU0MzIxMDEyMzQ1Ng==");return CryptoJS.AES.decrypt(t,s,{mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7,iv:o}).toString(CryptoJS.enc.Utf8)||null}catch{return null}},jsEval:r=>{if(r.includes("ﾟωﾟﾉ")||r.includes("=~["))return null;if(r.includes("$$")||/^[\[\]\(\)\!\+]{10,}$/.test(r.trim()))try{let t=new Function("return "+r)();return typeof t=="string"?t:t.toString()}catch{return null}return null},url:r=>{if(r.includes("%"))try{let t=decodeURIComponent(r);return t===r?null:t}catch{return null}return null}},getReadableScore=r=>{if(!r||typeof r!="string"||r.length===0)return 0;let t=0;for(let s=0;s<r.length;s++){const o=r.charCodeAt(s);(o>=32&&o<=126||o===10||o===13)&&t++}return t/r.length},runRecursive=r=>{let t=r,s=[],o=20;for(let e=0;e<o;e++){let l=null,n="",c=-1;if(!l){let i=Decoders.jjDecode(t);if(i)l=i,n="JJEncode";else{let a=Decoders.aaDecode(t);a&&(l=a,n="AAEncode")}}if(!l){let i=Decoders.base16(t);i&&i!==t&&getReadableScore(i)>.6&&(l=i,n="Hex")}if(!l){const i=[{name:"Base32",fn:Decoders.base32},{name:"Base64",fn:Decoders.base64},{name:"XXEncode",fn:Decoders.xxDecode},{name:"UUEncode",fn:Decoders.uuDecode}];for(let a of i){let d=a.fn(t);if(d&&d!==t){let u=getReadableScore(d);u>c&&u>.6&&(c=u,l=d,n=a.name)}}}if(l||(Decoders.buddhaDecode(t)?(l=Decoders.buddhaDecode(t),n="Buddha"):Decoders.url(t)?(l=Decoders.url(t),n="URL"):Decoders.jsEval(t)&&(l=Decoders.jsEval(t),n="JSFuck")),l)s.push(n),t=l;else break}return s.length>0?{value:t,path:s}:null},processInput=()=>{const r=inputText.value.trim();if(!r){results.value=[],recursiveResult.value=null;return}const t=[],s=(e,l)=>{let n=l(r);n&&n!==r&&n.length>0&&t.push({name:e,value:n})};s("JJEncode",Decoders.jjDecode),s("AAEncode",Decoders.aaDecode),s("UUEncode",Decoders.uuDecode),s("XXEncode",Decoders.xxDecode),s("Base64",Decoders.base64),/^[A-Z2-7=\s]+$/.test(r)&&s("Base32",Decoders.base32),s("Base16 (Hex)",Decoders.base16),s("Base85 (Ascii85)",Decoders.base85),s("Base91",Decoders.base91),s("Base62",Decoders.base62),s("Base58",Decoders.base58),s("Base36",Decoders.base36),s("Brainfuck",Decoders.brainfuck),s("与佛论禅",Decoders.buddhaDecode),s("URL Decode",Decoders.url),s("JSFuck (Eval)",Decoders.jsEval),results.value=t;const o=runRecursive(r);o&&(recursiveResult.value=o)};watch(inputText,()=>{timeoutId&&clearTimeout(timeoutId),timeoutId=setTimeout(processInput,300)});const clear=()=>{inputText.value="",results.value=[],recursiveResult.value=null},copy=r=>{navigator.clipboard.writeText(r)};return(r,t)=>(openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("h3",_hoisted_4,[createVNode(unref(render),{class:"w-5 h-5 text-cyber-primary"}),t[2]||(t[2]=createBaseVNode("span",null,"密文输入 (Input)",-1))]),createBaseVNode("button",{onClick:clear,class:"text-xs text-slate-400 hover:text-white px-3 py-1 bg-slate-800 rounded border border-slate-700 transition"},"清空")]),withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>inputText.value=s),class:"flex-1 w-full bg-slate-900/80 border-x border-b border-slate-700 rounded-b-xl p-4 text-sm font-mono text-slate-300 focus:outline-none focus:ring-1 focus:ring-cyber-primary resize-none placeholder-slate-600 leading-relaxed",placeholder:`在此粘贴密文... \r
支持: JJEncode / UUEncode / XXEncode 等（AAEncode由于技术限制无法支持，请移步超级大解码pro max ultra）\r
Base系列: 16 / 32 / 36 / 58 / 62 / 64 / 85 / 91\r
Script: JSFuck, Brainfuck`},null,512),[[vModelText,inputText.value]])]),createBaseVNode("div",_hoisted_5,[createBaseVNode("div",_hoisted_6,[createBaseVNode("h3",_hoisted_7,[createVNode(unref(render$1),{class:"w-5 h-5 text-cyber-success"}),t[3]||(t[3]=createBaseVNode("span",null,"解码结果 (Results)",-1))]),results.value.length?(openBlock(),createElementBlock("span",_hoisted_8," Found "+toDisplayString(results.value.length)+" candidates ",1)):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_9,[inputText.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_10,[createVNode(unref(render$2),{class:"w-16 h-16 mb-2 opacity-20"}),t[4]||(t[4]=createBaseVNode("p",{class:"text-sm"},"等待输入信号...",-1))])),createVNode(TransitionGroup,{name:"list",tag:"div",class:"space-y-4"},{default:withCtx(()=>[recursiveResult.value?(openBlock(),createElementBlock("div",_hoisted_11,[t[7]||(t[7]=createBaseVNode("div",{class:"absolute top-0 left-0 w-1 h-full bg-cyber-success"},null,-1)),createBaseVNode("div",_hoisted_12,[t[5]||(t[5]=createBaseVNode("span",{class:"text-xs font-bold text-cyber-success flex items-center gap-2"},[createBaseVNode("span",{class:"relative flex h-2 w-2"},[createBaseVNode("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),createBaseVNode("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]),createTextVNode(" 智能递归解码 (Smart Recursive) ")],-1)),createBaseVNode("button",{onClick:t[1]||(t[1]=s=>copy(recursiveResult.value.value)),class:"text-xs text-cyber-success hover:text-white border border-cyber-success/30 px-2 py-1 rounded transition"},"Copy")]),createBaseVNode("div",_hoisted_13,[t[6]||(t[6]=createBaseVNode("span",{class:"text-slate-500"},"Path:",-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(recursiveResult.value.path,(s,o)=>(openBlock(),createElementBlock(Fragment,{key:o},[createBaseVNode("span",_hoisted_14,toDisplayString(s),1),o<recursiveResult.value.path.length-1?(openBlock(),createElementBlock("span",_hoisted_15,"→")):createCommentVNode("",!0)],64))),128))]),createBaseVNode("div",_hoisted_16,[createBaseVNode("pre",_hoisted_17,toDisplayString(recursiveResult.value.value),1)])])):createCommentVNode("",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(results.value,s=>(openBlock(),createElementBlock("div",{key:s.name,class:"bg-slate-800 border border-slate-700 rounded-lg overflow-hidden group hover:border-slate-500 transition-colors"},[createBaseVNode("div",_hoisted_18,[createBaseVNode("span",_hoisted_19,toDisplayString(s.name),1),createBaseVNode("button",{onClick:o=>copy(s.value),class:"text-xs text-slate-500 group-hover:text-white bg-slate-700 hover:bg-cyber-primary px-2 py-0.5 rounded transition"},"Copy",8,_hoisted_20)]),createBaseVNode("div",_hoisted_21,[createBaseVNode("pre",_hoisted_22,toDisplayString(s.value),1)])]))),128))]),_:1})])])]))}},CyberDecoder=_export_sfc(_sfc_main,[["__scopeId","data-v-a125a402"]]);export{CyberDecoder as default};
