import{c as v,a as t,o as c,_ as M,r as y,b as u,u as d,C as V,e as r,A as p,B as U,v as E,n as F,g as H,d as k}from"./index-CHdk52Yy.js";import{C as a}from"./index-CbxcYopB.js";import"./_commonjsHelpers-DsqdWQfm.js";function P(f,o){return c(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 13.5V3.75m0 9.75a1.5 1.5 0 0 1 0 3m0-3a1.5 1.5 0 0 0 0 3m0 3.75V16.5m12-3V3.75m0 9.75a1.5 1.5 0 0 1 0 3m0-3a1.5 1.5 0 0 0 0 3m0 3.75V16.5m-6-9V3.75m0 3.75a1.5 1.5 0 0 1 0 3m0-3a1.5 1.5 0 0 0 0 3m0 9.75V10.5"})])}function T(f,o){return c(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}function $(f,o){return c(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})])}function j(f,o){return c(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 10.5V6.75a4.5 4.5 0 1 1 9 0v3.75M3.75 21.75h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H3.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])}const D={class:"h-full flex flex-col xl:flex-row gap-6"},I={class:"xl:w-1/3 flex flex-col gap-4 min-w-[320px]"},N={class:"bg-cyber-panel border border-slate-700 rounded-xl p-6 shadow-lg relative overflow-hidden"},z={class:"absolute top-0 right-0 p-4 opacity-10"},A={class:"text-xl font-bold text-white mb-6 flex items-center gap-2 relative z-10"},O={class:"space-y-5 relative z-10"},L={class:"grid grid-cols-2 gap-4"},Z={class:"flex justify-between items-center mb-1"},G={class:"relative"},J={class:"flex justify-between items-center mb-1"},W={class:"relative"},q={key:0,class:"text-[10px] text-orange-400 mt-1"},K={class:"grid grid-cols-2 gap-4 mt-8"},Q={class:"flex-1 flex flex-col gap-4 min-w-[300px]"},X={class:"flex-1 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-lg"},Y={class:"bg-slate-800 p-2 px-4 border-b border-slate-700 flex justify-between items-center"},_={class:"flex items-center gap-2"},ee={class:"flex-1 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-lg"},te={class:"bg-slate-800 p-2 px-4 border-b border-slate-700 flex justify-between items-center"},oe=["value"],le={__name:"CryptoAes",setup(f){const o=y({algo:"AES",mode:"CBC",padding:"Pkcs7",key:"",keyEnc:"utf8",iv:"",ivEnc:"utf8"}),n=y({inputEnc:"utf8",outputEnc:"base64"}),x=y(""),i=y(""),m=(s,e)=>e==="utf8"?a.enc.Utf8.parse(s):e==="base64"?a.enc.Base64.parse(s.replace(/\s/g,"")):e==="hex"?a.enc.Hex.parse(s.replace(/\s/g,"")):s,C=(s,e)=>{if(e==="base64")return a.enc.Base64.stringify(s);if(e==="hex")return a.enc.Hex.stringify(s);if(e==="utf8")try{return a.enc.Utf8.stringify(s)}catch{return"[Error] Result is not valid UTF-8 text. Try switching output to Hex/Base64."}},h=s=>{const e=o.value.algo==="DES"?8:16,l=a.lib.WordArray.random(e),b=a.enc.Hex.stringify(l);s==="key"?(o.value.key=b,o.value.keyEnc="hex"):(o.value.iv=b,o.value.ivEnc="hex")},R=()=>{x.value=i.value,i.value="";const s=n.value.inputEnc;n.value.inputEnc=n.value.outputEnc,n.value.outputEnc=s},B=s=>{try{if(!o.value.key)throw new Error("请输入密钥！");const e=a[o.value.algo];if(!e)throw new Error("Algorithm not supported");const l={mode:a.mode[o.value.mode],padding:a.pad[o.value.padding]};if(o.value.mode!=="ECB"){if(!o.value.iv)throw new Error("请输入 IV");l.iv=m(o.value.iv,o.value.ivEnc)}const b=m(o.value.key,o.value.keyEnc);let g;if(s==="decrypt"){g=m(x.value,n.value.inputEnc);const w=a.lib.CipherParams.create({ciphertext:g}),S=e.decrypt(w,b,l);i.value=C(S,n.value.outputEnc),i.value||(i.value="[Decryption Failed or Empty Result]")}else{g=m(x.value,n.value.inputEnc);const w=e.encrypt(g,b,l);i.value=C(w.ciphertext,n.value.outputEnc)}}catch(e){i.value=`[ERROR]: ${e.message}`}};return(s,e)=>(c(),v("div",D,[t("div",I,[t("div",N,[t("div",z,[u(d(V),{class:"w-24 h-24 text-cyber-primary"})]),t("h2",A,[u(d(P),{class:"w-6 h-6 text-cyber-primary"}),e[14]||(e[14]=t("span",null,"算法参数 (Config)",-1))]),t("div",O,[t("div",L,[t("div",null,[e[16]||(e[16]=t("label",{class:"label-text"},"加密算法",-1)),r(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.algo=l),class:"input-cyber"},[...e[15]||(e[15]=[U('<option value="AES" data-v-957cb4be>AES</option><option value="DES" data-v-957cb4be>DES</option><option value="TripleDES" data-v-957cb4be>3DES</option><option value="Rabbit" data-v-957cb4be>Rabbit</option><option value="RC4" data-v-957cb4be>RC4</option>',5)])],512),[[p,o.value.algo]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"label-text"},"模式",-1)),r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.mode=l),class:"input-cyber"},[...e[17]||(e[17]=[U('<option value="CBC" data-v-957cb4be>CBC</option><option value="ECB" data-v-957cb4be>ECB</option><option value="CFB" data-v-957cb4be>CFB</option><option value="OFB" data-v-957cb4be>OFB</option><option value="CTR" data-v-957cb4be>CTR</option>',5)])],512),[[p,o.value.mode]])])]),t("div",null,[e[20]||(e[20]=t("label",{class:"label-text"},"Padding",-1)),r(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.padding=l),class:"input-cyber w-full"},[...e[19]||(e[19]=[t("option",{value:"Pkcs7"},"Pkcs7 (Default)",-1),t("option",{value:"ZeroPadding"},"ZeroPadding",-1),t("option",{value:"Iso10126"},"Iso10126",-1),t("option",{value:"NoPadding"},"NoPadding",-1)])],512),[[p,o.value.padding]])]),e[25]||(e[25]=t("div",{class:"border-t border-slate-700 my-4"},null,-1)),t("div",null,[t("div",Z,[e[22]||(e[22]=t("label",{class:"label-text"},"密钥",-1)),r(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.keyEnc=l),class:"text-[10px] bg-slate-800 text-slate-400 border border-slate-600 rounded px-1"},[...e[21]||(e[21]=[t("option",{value:"utf8"},"UTF-8",-1),t("option",{value:"hex"},"Hex",-1),t("option",{value:"base64"},"Base64",-1)])],512),[[p,o.value.keyEnc]])]),t("div",G,[r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.key=l),type:"text",class:"input-cyber w-full pr-8 font-mono text-sm text-cyber-accent",placeholder:"Enter key..."},null,512),[[E,o.value.key]]),t("button",{onClick:e[5]||(e[5]=l=>h("key")),class:"absolute right-2 top-2 text-slate-500 hover:text-white",title:"Generate Random"},[u(d(T),{class:"w-4 h-4"})])])]),t("div",{class:F({"opacity-50 pointer-events-none":o.value.mode==="ECB"})},[t("div",J,[e[24]||(e[24]=t("label",{class:"label-text"},"IV (初始化向量)",-1)),r(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.ivEnc=l),class:"text-[10px] bg-slate-800 text-slate-400 border border-slate-600 rounded px-1"},[...e[23]||(e[23]=[t("option",{value:"utf8"},"UTF-8",-1),t("option",{value:"hex"},"Hex",-1),t("option",{value:"base64"},"Base64",-1)])],512),[[p,o.value.ivEnc]])]),t("div",W,[r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.iv=l),type:"text",class:"input-cyber w-full pr-8 font-mono text-sm text-cyber-accent",placeholder:"Enter IV..."},null,512),[[E,o.value.iv]]),t("button",{onClick:e[8]||(e[8]=l=>h("iv")),class:"absolute right-2 top-2 text-slate-500 hover:text-white",title:"Generate Random"},[u(d(T),{class:"w-4 h-4"})])]),o.value.mode==="ECB"?(c(),v("p",q,"* ECB 模式不需要 IV")):H("",!0)],2)]),t("div",K,[t("button",{onClick:e[9]||(e[9]=l=>B("encrypt")),class:"btn-action bg-cyber-primary text-cyber-bg hover:bg-white"},[u(d(V),{class:"w-4 h-4"}),e[26]||(e[26]=k(" 加密 ",-1))]),t("button",{onClick:e[10]||(e[10]=l=>B("decrypt")),class:"btn-action bg-cyber-accent text-white hover:bg-blue-600"},[u(d(j),{class:"w-4 h-4"}),e[27]||(e[27]=k(" 解密 ",-1))])])])]),t("div",Q,[t("div",X,[t("div",Y,[e[30]||(e[30]=t("span",{class:"text-xs font-bold text-slate-300"},"输入待加密数据",-1)),t("div",_,[t("button",{onClick:R,class:"text-xs flex items-center gap-1 text-slate-400 hover:text-cyber-primary transition"},[u(d($),{class:"w-3 h-3"}),e[28]||(e[28]=k(" Swap ",-1))]),r(t("select",{"onUpdate:modelValue":e[11]||(e[11]=l=>n.value.inputEnc=l),class:"text-[10px] bg-slate-900 text-slate-300 border border-slate-600 rounded px-2 py-0.5"},[...e[29]||(e[29]=[t("option",{value:"utf8"},"Text (UTF-8)",-1),t("option",{value:"base64"},"Base64",-1),t("option",{value:"hex"},"Hex",-1)])],512),[[p,n.value.inputEnc]])])]),r(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=l=>x.value=l),class:"flex-1 w-full bg-slate-900/50 p-4 font-mono text-sm text-slate-300 outline-none resize-none",placeholder:"请输入..."},null,512),[[E,x.value]])]),t("div",ee,[t("div",te,[e[32]||(e[32]=t("span",{class:"text-xs font-bold text-cyber-success"},"输出结果",-1)),r(t("select",{"onUpdate:modelValue":e[13]||(e[13]=l=>n.value.outputEnc=l),class:"text-[10px] bg-slate-900 text-slate-300 border border-slate-600 rounded px-2 py-0.5"},[...e[31]||(e[31]=[t("option",{value:"base64"},"Base64",-1),t("option",{value:"hex"},"Hex",-1),t("option",{value:"utf8"},"Text (UTF-8)",-1)])],512),[[p,n.value.outputEnc]])]),t("textarea",{readonly:"",value:i.value,class:"flex-1 w-full bg-black/40 p-4 font-mono text-sm text-cyber-success outline-none resize-none",placeholder:"结果会输出在这里..."},null,8,oe)])])]))}},re=M(le,[["__scopeId","data-v-957cb4be"]]);export{re as default};
