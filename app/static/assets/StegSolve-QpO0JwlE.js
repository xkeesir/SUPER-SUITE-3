import{c as f,a as t,o as b,_ as se,r as p,p as le,b as B,d as A,u as I,x as ne,t as h,w as z,g as R,y as ae,z as re,e as O,v as ie,F as de,h as ce,A as G,B as ue}from"./index-CI3-vDyV.js";import{r as pe}from"./ArrowUpTrayIcon-DBQej319.js";import{r as fe}from"./SparklesIcon-D_KrWZAU.js";function be(Y,V){return b(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"})])}const xe={class:"h-full flex flex-col lg:flex-row gap-6 p-4"},ve={class:"flex-[2] flex flex-col gap-4 min-w-[300px]"},ge={class:"bg-slate-900 border border-slate-700 rounded-xl shadow-lg flex flex-col flex-1 overflow-hidden relative"},me={class:"h-12 bg-slate-800 border-b border-slate-700 flex items-center justify-between px-4 shrink-0"},he={class:"font-bold text-blue-400 flex items-center gap-2"},we={class:"text-xs bg-black px-2 py-1 rounded text-slate-300 font-mono border border-slate-700"},ye={key:0,class:"text-center pointer-events-none"},_e={class:"h-16 bg-slate-800 border-t border-slate-700 flex items-center justify-between px-4 shrink-0 gap-4"},ke={class:"flex items-center gap-3"},Ce={class:"flex-1 flex flex-col gap-4 min-w-[300px]"},Se={class:"bg-slate-900 border border-slate-700 rounded-xl shadow-lg flex flex-col"},Be={class:"p-3 border-b border-slate-700 bg-slate-800/50"},Ie={class:"font-bold text-green-400 flex items-center gap-2 text-sm"},Re={class:"p-4 space-y-3"},Le={class:"flex gap-2"},Me=["disabled"],$e={key:0,class:"animate-spin text-[10px]"},Fe={key:0,class:"max-h-[150px] overflow-y-auto space-y-2 border border-slate-700 bg-black p-2 rounded custom-scrollbar"},Ue=["onClick"],De={class:"flex justify-between text-slate-400 mb-1"},Ae={class:"font-mono text-green-300 break-all bg-black/50 p-1 rounded"},Oe={key:1,class:"text-[10px] text-slate-500 text-center py-2"},Ve={class:"bg-slate-900 border border-slate-700 rounded-xl shadow-lg flex flex-col flex-1 overflow-hidden"},je={class:"p-3 border-b border-slate-700 bg-slate-800/50"},Ee={class:"font-bold text-white flex items-center gap-2 text-sm"},Ge={class:"p-4 space-y-4 overflow-y-auto flex-1 custom-scrollbar"},Ne={class:"grid grid-cols-2 gap-3"},Pe={class:"col-span-2"},Te={class:"text-[10px] uppercase text-slate-400 font-bold block mb-1 flex justify-between"},Xe={key:0,class:"text-green-500 text-[9px]"},qe={class:"flex-1 flex flex-col min-h-[200px]"},ze={class:"flex justify-between items-center mb-1"},Ye=["value"],He={__name:"StegSolve",setup(Y){const V=p(null),L=p(!1),w=p(0);let u=null,y=null;const x=p({mode:"rgb",bitOrder:"lsb",direction:"xy"}),M=p([]),j=p(""),$=p("flag"),_=p(!1),k=p([]),E=p(!1),F=(s,e)=>{const o=[];for(let l=7;l>=0;l--)o.push({name:`${s} Plane ${l}`,func:(n,i,a,g)=>{const r=([n,i,a,g][e]>>l&1)===1?255:0;return[r,r,r,255]}});return o},U=[{name:"Normal Image",func:(s,e,o,l)=>[s,e,o,l]},{name:"Inverted",func:(s,e,o,l)=>[255-s,255-e,255-o,l]},...F("Red",0),...F("Green",1),...F("Blue",2),...F("Alpha",3)],H=le(()=>U[w.value].name),K=s=>N(s.dataTransfer.files[0]),W=s=>N(s.target.files[0]),N=s=>{s&&createImageBitmap(s,{colorSpaceConversion:"none"}).then(e=>{const o=V.value;y=o.getContext("2d",{willReadFrequently:!0}),o.width=e.width,o.height=e.height,y.drawImage(e,0,0),u=y.getImageData(0,0,o.width,o.height),L.value=!0,o.style.display="block",w.value=0,k.value=[],j.value="",M.value=[],T()}).catch(e=>{console.error("图片加载失败:",e),alert("无法读取该图片，可能格式不支持或文件损坏。")})},P=s=>{if(!L.value)return;let e=w.value+s;e>=U.length&&(e=0),e<0&&(e=U.length-1),w.value=e,T()},T=()=>{if(!u)return;const s=U[w.value],e=u.width,o=u.height,l=u.data,n=y.createImageData(e,o),i=n.data;if(w.value===0){y.putImageData(u,0,0);return}for(let a=0;a<l.length;a+=4){const[g,C,v,r]=s.func(l[a],l[a+1],l[a+2],l[a+3]);i[a]=g,i[a+1]=C,i[a+2]=v,i[a+3]=r}y.putImageData(n,0,0)},X=(s,e)=>{const o=s.data,l=s.width,n=s.height,{mode:i,bitOrder:a,direction:g}=e,v={rgb:[0,1,2],bgr:[2,1,0],rgba:[0,1,2,3],abgr:[3,2,1,0],r:[0],g:[1],b:[2],a:[3]}[i]||[0,1,2];let r=[];if(g==="xy")for(let c=0;c<o.length;c+=4)for(let m of v)r.push(o[c+m]&1);else for(let c=0;c<l;c++)for(let m=0;m<n;m++){const te=(m*l+c)*4;for(let oe of v)r.push(o[te+oe]&1)}const D=[];let d=0,S=0;for(let c of r)a==="lsb"?d|=c<<S:d=d<<1|c,S++,S===8&&(D.push(d),d=0,S=0);return D},J=s=>{let e="",o="";const l=Math.min(s.length,1024);for(let n=0;n<l;n++)e+=s[n].toString(16).padStart(2,"0")+" ",o+=s[n]>=32&&s[n]<=126?String.fromCharCode(s[n]):".";j.value=`[HEX DUMP]:
${e}

[ASCII PREVIEW]:
${o}`},q=()=>{if(!u)return;const s=X(u,x.value);M.value=s,J(s)},Q=async()=>{if(!u)return;_.value=!0,k.value=[],E.value=!1;const s=["rgb","bgr","rgba","r","g","b"],e=["xy","yx"],o=["lsb","msb"],l=i=>new Promise(a=>setTimeout(a,i)),n=$.value.trim();if(!n){_.value=!1;return}try{for(let i of s)for(let a of e)for(let g of o){const C={mode:i,direction:a,bitOrder:g},v=X(u,C);let r="";const D=Math.min(v.length,5e3);for(let d=0;d<D;d++)r+=String.fromCharCode(v[d]);if(r.toLowerCase().includes(n.toLowerCase())){const d=r.toLowerCase().indexOf(n.toLowerCase()),S=Math.max(0,d-10),c=Math.min(r.length,d+40),m=r.substring(S,c).replace(/[^\x20-\x7E]/g,".");k.value.push({config:C,preview:`...${m}...`})}await l(10)}}finally{_.value=!1,E.value=!0}},Z=s=>{x.value={...s},q()},ee=()=>{const s=new Uint8Array(M.value),e=new Blob([s],{type:"application/octet-stream"}),o=URL.createObjectURL(e),l=document.createElement("a");l.href=o,l.download="extracted_steg.bin",l.click(),URL.revokeObjectURL(o)};return(s,e)=>(b(),f("div",xe,[t("div",ve,[t("div",ge,[t("div",me,[t("span",he,[B(I(ne),{class:"w-5 h-5"}),e[8]||(e[8]=A(" 图像预览 ",-1))]),t("span",we,h(H.value),1)]),t("div",{class:"flex-1 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] bg-slate-950 relative overflow-auto flex items-center justify-center p-4",onDragover:e[0]||(e[0]=z(()=>{},["prevent"])),onDrop:z(K,["prevent"])},[L.value?R("",!0):(b(),f("div",ye,[B(I(pe),{class:"w-12 h-12 text-slate-600 mx-auto mb-2"}),e[9]||(e[9]=t("p",{class:"text-slate-500 text-sm"},"拖拽图片到此处 或 点击下方按钮",-1))])),t("canvas",{ref_key:"canvasRef",ref:V,class:"max-w-full shadow-2xl border border-slate-700 image-pixelated",style:{display:"none"}},null,512)],32),t("div",_e,[t("button",{onClick:e[1]||(e[1]=o=>P(-1)),class:"btn-icon",title:"上一通道"},[B(I(ae),{class:"w-5 h-5"})]),t("div",ke,[t("input",{type:"file",ref:"fileInput",accept:"image/*",class:"hidden",onChange:W},null,544),t("button",{onClick:e[2]||(e[2]=o=>s.$refs.fileInput.click()),class:"bg-blue-600 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-blue-500 transition shadow-lg shadow-blue-900/50"}," 选择图像文件 ")]),t("button",{onClick:e[3]||(e[3]=o=>P(1)),class:"btn-icon",title:"下一通道"},[B(I(re),{class:"w-5 h-5"})])])])]),t("div",Ce,[t("div",Se,[t("div",Be,[t("h3",Ie,[B(I(fe),{class:"w-4 h-4"}),e[10]||(e[10]=A(" 智能探测 (Auto Solver) ",-1))])]),t("div",Re,[t("div",Le,[O(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>$.value=o),type:"text",placeholder:"输入关键字 (如: flag)",class:"flex-1 bg-black border border-slate-600 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-green-500"},null,512),[[ie,$.value]]),t("button",{onClick:Q,disabled:_.value||!L.value,class:"bg-green-600 text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 transition-all"},[_.value?(b(),f("span",$e,"⟳")):R("",!0),A(" "+h(_.value?"扫描中...":"一键扫描"),1)],8,Me)]),k.value.length>0?(b(),f("div",Fe,[(b(!0),f(de,null,ce(k.value,(o,l)=>(b(),f("div",{key:l,onClick:n=>Z(o.config),class:"text-[10px] p-2 bg-slate-900 border border-slate-700 rounded cursor-pointer hover:border-green-500 group transition-colors"},[t("div",De,[t("span",null,h(o.config.mode.toUpperCase())+" | "+h(o.config.direction.toUpperCase())+" | "+h(o.config.bitOrder.toUpperCase()),1),e[11]||(e[11]=t("span",{class:"text-green-500 font-bold"},"点击查看",-1))]),t("div",Ae,h(o.preview),1)],8,Ue))),128))])):E.value&&k.value.length===0?(b(),f("div",Oe,' 未找到包含 "'+h($.value)+'" 的结果，请尝试手动提取。 ',1)):R("",!0)])]),t("div",Ve,[t("div",je,[t("h3",Ee,[B(I(be),{class:"w-4 h-4 text-blue-400"}),e[12]||(e[12]=A(" 手动提取参数 ",-1))])]),t("div",Ge,[t("div",Ne,[t("div",null,[e[14]||(e[14]=t("label",{class:"text-[10px] uppercase text-slate-400 font-bold block mb-1"},"通道 (Mode)",-1)),O(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>x.value.mode=o),class:"config-select"},[...e[13]||(e[13]=[ue('<optgroup label="组合" data-v-036fcb62><option value="rgb" data-v-036fcb62>RGB</option><option value="bgr" data-v-036fcb62>BGR</option><option value="rgba" data-v-036fcb62>RGBA</option><option value="abgr" data-v-036fcb62>ABGR</option></optgroup><optgroup label="单通道" data-v-036fcb62><option value="r" data-v-036fcb62>Red</option><option value="g" data-v-036fcb62>Green</option><option value="b" data-v-036fcb62>Blue</option><option value="a" data-v-036fcb62>Alpha</option></optgroup>',2)])],512),[[G,x.value.mode]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"text-[10px] uppercase text-slate-400 font-bold block mb-1"},"位顺序 (Bit Order)",-1)),O(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>x.value.bitOrder=o),class:"config-select"},[...e[15]||(e[15]=[t("option",{value:"lsb"},"LSB First",-1),t("option",{value:"msb"},"MSB First",-1)])],512),[[G,x.value.bitOrder]])]),t("div",Pe,[t("label",Te,[e[17]||(e[17]=t("span",null,"扫描方向 (Scan Direction)",-1)),x.value.direction==="yx"?(b(),f("span",Xe,"★ 推荐用于 CTF")):R("",!0)]),O(t("select",{"onUpdate:modelValue":e[7]||(e[7]=o=>x.value.direction=o),class:"config-select"},[...e[18]||(e[18]=[t("option",{value:"xy"},"Row (X → Y) [标准]",-1),t("option",{value:"yx"},"Column (Y → X) [StegSolve]",-1)])],512),[[G,x.value.direction]])])]),t("button",{onClick:q,class:"w-full bg-blue-600 text-white py-2 rounded text-xs font-bold hover:bg-blue-500 transition shadow-lg"}," 提取数据 (Extract) "),t("div",qe,[t("div",ze,[e[19]||(e[19]=t("span",{class:"text-[10px] font-bold text-slate-400"},"结果预览 (前 1024 字节)",-1)),M.value.length?(b(),f("button",{key:0,onClick:ee,class:"text-[10px] text-blue-400 hover:text-white transition"},"⬇ 导出 .bin")):R("",!0)]),t("textarea",{readonly:"",value:j.value,class:"flex-1 w-full bg-black border border-slate-700 rounded p-2 font-mono text-[10px] text-green-400 resize-none outline-none leading-relaxed custom-scrollbar",placeholder:"提取的数据将显示在这里..."},null,8,Ye)])])])])]))}},Qe=se(He,[["__scopeId","data-v-036fcb62"]]);export{Qe as default};
