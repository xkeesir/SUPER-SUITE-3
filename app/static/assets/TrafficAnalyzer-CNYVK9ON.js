import{c as a,a as e,o,_ as M,r as n,b as N,d as w,u as m,e as f,A as k,v as D,t as r,g as x,F as P,h as C,n as i,J as U,q}from"./index-x8dj2Z4m.js";import{r as $}from"./LockOpenIcon-B5y2i9aS.js";function F(T,c){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"})])}const O={class:"h-full flex flex-col gap-4"},R={class:"bg-cyber-panel border border-slate-700 rounded-xl p-4 shadow-lg flex flex-wrap gap-4 items-center justify-between"},K={class:"flex items-center gap-4"},H={class:"relative group"},I={class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg transition-all font-bold text-sm shadow-blue-900/50 shadow-lg"},J={class:"flex items-center gap-3 bg-slate-800/50 p-1.5 rounded-lg border border-slate-700/50"},G={class:"flex flex-col gap-0.5"},L={class:"flex flex-col gap-0.5"},Q={class:"flex flex-col gap-0.5"},X={class:"flex flex-col gap-0.5"},Z={class:"text-slate-500 text-xs font-mono"},W={key:0,class:"text-blue-400 font-bold"},Y={key:1},ee={class:"flex-1 flex gap-4 min-h-0"},te={class:"w-1/3 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-lg"},se={class:"flex-1 overflow-auto custom-scrollbar"},le={class:"w-full text-xs font-mono border-collapse"},oe=["onClick"],ae=["title"],re={class:"px-3 py-2 text-right text-slate-500"},ne={key:0,class:"text-center py-10 text-slate-600 text-xs"},de={class:"flex-1 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-lg bg-[#0d1117]"},ie={key:0,class:"flex flex-col h-full"},ce={class:"bg-slate-800/90 px-6 py-3 border-b border-slate-700 flex justify-between items-center backdrop-blur-sm z-20"},pe={class:"flex items-center gap-3"},ue={class:"text-sm font-mono text-slate-400"},xe={key:0,class:"bg-purple-900/50 text-purple-200 px-2 py-0.5 rounded text-xs font-bold border border-purple-700/50"},be={class:"text-xs text-slate-500 font-mono"},fe={class:"flex-1 overflow-auto custom-scrollbar p-6 flex flex-col gap-6 relative"},ye={key:0,class:"absolute inset-0 bg-[#0d1117]/80 flex flex-col items-center justify-center z-10"},ve={key:1,class:"flex flex-col items-center justify-center h-full text-slate-600 gap-2"},he={class:"text-xs"},ge={class:"flex items-center gap-2 px-1 opacity-70"},_e={class:"text-[10px] font-mono text-slate-500 truncate max-w-[300px]"},we={class:"flex items-center justify-between px-3 py-1.5 bg-black/20 border-b border-white/5"},me={class:"text-[10px] text-slate-500 font-mono flex gap-2"},ke=["onClick","disabled"],De={key:1,class:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"},Pe={key:0,class:"bg-blue-500/5 border-b border-white/5 p-3 animate-fade-in"},Ce={class:"flex items-center gap-2 mb-2"},Te={class:"font-mono text-xs text-slate-300 whitespace-pre-wrap break-all leading-relaxed bg-black/30 p-2 rounded border border-white/10 max-h-[400px] overflow-auto custom-scrollbar"},Se={class:"p-3 relative"},je={key:0,class:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-[#1c2128] to-transparent flex items-end justify-center pb-1"},ze=["onClick"],Ee={key:1,class:"flex-1 flex flex-col items-center justify-center text-slate-600 gap-4"},Be={__name:"TrafficAnalyzer",setup(T){const c=n([]),d=n(null),y=n(!1),b=n(!1),u=n([]),v=n("godzilla"),h=n("jsp"),g=n("pass"),_=n("key"),S=async l=>{const s=l.target.files[0];if(!s)return;y.value=!0,c.value=[],d.value=null;const t=new FormData;t.append("file",s);try{const p=await fetch("/api/traffic/analyze",{method:"POST",body:t});p.ok&&(c.value=await p.json())}finally{y.value=!1}},j=async l=>{d.value=l,u.value=[],b.value=!0;try{const s=await fetch(`/api/traffic/stream_messages/${l.stream_id}`);if(s.ok){const t=await s.json();u.value=t.map(p=>({...p,isExpanded:!1,isDecrypting:!1,decryptedData:null}))}}finally{b.value=!1}},z=l=>{try{if(!l)return"";const s=atob(l);return s.length>3e3?s.substring(0,3e3)+"... (Truncated)":s}catch{return"[Binary Content]"}},E=async l=>{l.isDecrypting=!0,l.decryptedData=null;try{const t=await(await fetch("/api/traffic/decrypt_shell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload_b64:l.raw_b64,tool:v.value,script_type:h.value,password:g.value,secret_key:_.value})})).json();t.status==="success"?(l.decryptedData=t.content,l.isExpanded=!1):l.decryptedData=[]}catch(s){console.error(s)}finally{l.isDecrypting=!1}},B=l=>({success:"bg-green-400",info:"bg-blue-400",warning:"bg-yellow-400",neutral:"bg-slate-400"})[l]||"bg-slate-400",V=l=>({success:"text-green-400",info:"text-blue-400",warning:"text-yellow-400",neutral:"text-slate-400"})[l]||"text-slate-400";return(l,s)=>(o(),a("div",O,[e("div",R,[e("div",K,[e("div",H,[e("button",I,[N(m(F),{class:"w-5 h-5"}),s[4]||(s[4]=w(" Upload PCAP ",-1))]),e("input",{type:"file",accept:".pcap,.pcapng",onChange:S,class:"absolute inset-0 opacity-0 cursor-pointer"},null,32)]),s[11]||(s[11]=e("div",{class:"h-8 w-[1px] bg-slate-700 mx-2"},null,-1)),e("div",J,[e("div",G,[s[6]||(s[6]=e("label",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-wider pl-1"},"Tool",-1)),f(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t),class:"bg-slate-800 border border-slate-600 text-white text-xs rounded px-2 py-1.5 focus:border-blue-500 outline-none w-28"},[...s[5]||(s[5]=[e("option",{value:"godzilla"},"Godzilla",-1),e("option",{value:"behinder"},"Behinder",-1)])],512),[[k,v.value]])]),e("div",L,[s[8]||(s[8]=e("label",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-wider pl-1"},"Script",-1)),f(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>h.value=t),class:"bg-slate-800 border border-slate-600 text-white text-xs rounded px-2 py-1.5 focus:border-blue-500 outline-none w-20"},[...s[7]||(s[7]=[e("option",{value:"jsp"},"JSP",-1),e("option",{value:"php"},"PHP",-1),e("option",{value:"aspx"},"ASPX",-1)])],512),[[k,h.value]])]),e("div",Q,[s[9]||(s[9]=e("label",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-wider pl-1"},"Pass",-1)),f(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>g.value=t),type:"text",placeholder:"Pass",class:"bg-slate-800 border border-slate-600 text-white text-xs rounded px-2 py-1.5 focus:border-blue-500 outline-none w-24 font-mono"},null,512),[[D,g.value,void 0,{trim:!0}]])]),e("div",X,[s[10]||(s[10]=e("label",{class:"text-[10px] text-yellow-600/80 font-bold uppercase tracking-wider pl-1"},"Key",-1)),f(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>_.value=t),type:"text",placeholder:"Key (Opt)",class:"bg-slate-800 border border-slate-600 text-yellow-400 text-xs rounded px-2 py-1.5 focus:border-yellow-500 outline-none w-32 font-mono"},null,512),[[D,_.value,void 0,{trim:!0}]])])])]),e("div",Z,[c.value.length?(o(),a("span",W,r(c.value.length)+" Streams",1)):(o(),a("span",Y,"No File"))])]),e("div",ee,[e("div",te,[s[13]||(s[13]=e("div",{class:"bg-slate-800/80 px-4 py-2 border-b border-slate-700"},[e("span",{class:"font-bold text-slate-200 text-sm"},"Conversations")],-1)),e("div",se,[e("table",le,[s[12]||(s[12]=e("thead",{class:"sticky top-0 bg-slate-900/95 text-slate-400 z-10 shadow-sm"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left w-16"},"Type"),e("th",{class:"px-3 py-2 text-left"},"URI / Info"),e("th",{class:"px-3 py-2 text-right w-20"},"Size")])],-1)),e("tbody",null,[(o(!0),a(P,null,C(c.value,t=>(o(),a("tr",{key:t.id,onClick:p=>j(t),class:i(["cursor-pointer border-b border-slate-800/50 transition-colors h-10",d.value?.id===t.id?"bg-blue-900/20 border-l-2 border-l-blue-400":"hover:bg-slate-800/30 border-l-2 border-l-transparent"])},[e("td",{class:i(["px-3 py-2 font-bold",{"text-blue-400":t.method==="POST","text-green-400":t.method==="GET","text-purple-400":t.method==="RESP","text-slate-500":t.method==="TCP"}])},r(t.method),3),e("td",{class:"px-3 py-2 text-slate-300 truncate max-w-[140px]",title:t.uri},r(t.uri||"-"),9,ae),e("td",re,r((t.payload_len/1024).toFixed(1))+" KB",1)],10,oe))),128))])]),c.value.length===0&&!y.value?(o(),a("div",ne," No HTTP/TCP streams found. ")):x("",!0)])]),e("div",de,[d.value?(o(),a("div",ie,[e("div",ce,[e("div",pe,[e("span",ue,"Stream #"+r(d.value.id),1),d.value.shell_type!=="unknown"?(o(),a("span",xe,r(d.value.shell_type.toUpperCase()),1)):x("",!0)]),e("div",be,r(u.value.length)+" Message(s) ",1)]),e("div",fe,[b.value?(o(),a("div",ye,[...s[14]||(s[14]=[e("div",{class:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mb-2"},null,-1),e("span",{class:"text-xs text-slate-400"},"Parsing...",-1)])])):x("",!0),!b.value&&u.value.length===0?(o(),a("div",ve,[e("span",he,"No recognizable content found. Stream size: "+r(d.value.payload_len)+" bytes.",1)])):(o(!0),a(P,{key:2},C(u.value,(t,p)=>(o(),a("div",{key:t.seq,class:i(["flex flex-col gap-1 max-w-full animate-fade-in",t.type==="req"?"items-start":"items-end"]),style:U({animationDelay:`${p*.05}s`})},[e("div",ge,[e("span",{class:i(["text-[9px] font-bold uppercase tracking-wider px-1.5 py-0.5 rounded",t.type==="req"?"bg-blue-900 text-blue-300":"bg-green-900 text-green-300"])},r(t.type==="req"?"REQ":"RESP"),3),e("span",_e,r(t.header_summary),1)]),e("div",{class:i(["w-full max-w-[95%] rounded-lg border shadow-lg overflow-hidden transition-all duration-300 group",t.type==="req"?"bg-[#1c2128] border-blue-900/30":"bg-[#161b22] border-green-900/30"])},[e("div",we,[e("div",me,[e("span",null,r(t.content_len)+" Bytes",1)]),e("button",{onClick:A=>E(t),disabled:t.isDecrypting,class:"flex items-center gap-1.5 px-2 py-1 rounded hover:bg-white/10 text-slate-400 hover:text-white text-[10px] font-bold transition-all disabled:opacity-50"},[t.isDecrypting?(o(),a("div",De)):(o(),q(m($),{key:0,class:"w-3 h-3"})),w(" "+r(t.decryptedData?"Decrypt Again":"Decrypt Payload"),1)],8,ke)]),t.decryptedData&&t.decryptedData.length>0?(o(),a("div",Pe,[e("div",Ce,[e("div",{class:i(["w-1.5 h-1.5 rounded-full",B(t.decryptedData[0]?.type)])},null,2),e("span",{class:i(["text-xs font-bold",V(t.decryptedData[0]?.type)])},r(t.decryptedData[0]?.title),3)]),e("div",Te,r(t.decryptedData[0]?.content),1)])):x("",!0),e("div",Se,[e("div",{class:i(["font-mono text-[10px] text-slate-500 whitespace-pre-wrap break-all leading-relaxed transition-all duration-300",t.isExpanded?"max-h-none":"max-h-[120px] overflow-hidden opacity-80"])},r(z(t.raw_b64)),3),!t.isExpanded&&t.content_len>250?(o(),a("div",je,[e("button",{onClick:A=>t.isExpanded=!0,class:"text-[9px] text-blue-400 hover:text-blue-300 bg-slate-900/80 px-2 py-0.5 rounded border border-slate-700"},"Show All",8,ze)])):x("",!0)])],2)],6))),128))])])):(o(),a("div",Ee,[...s[15]||(s[15]=[e("p",{class:"text-sm font-medium"},"Select a stream",-1)])]))])])]))}},Me=M(Be,[["__scopeId","data-v-deb02ef3"]]);export{Me as default};
