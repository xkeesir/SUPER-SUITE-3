import{c as w,a as t,o as y,_ as q,r as f,p as z,b as m,d as M,u as h,x as H,t as X,w as $,g as F,y as J,z as K,e as O,A as j,B as Q}from"./index-C2xc-8Yy.js";function W(R,k){return y(),w("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})])}function Y(R,k){return y(),w("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"})])}const Z={class:"h-full flex flex-col lg:flex-row gap-6"},ee={class:"flex-[2] flex flex-col gap-4 min-w-[300px]"},te={class:"bg-cyber-panel border border-slate-700 rounded-xl shadow-lg flex flex-col flex-1 overflow-hidden relative"},oe={class:"h-12 bg-slate-800 border-b border-slate-700 flex items-center justify-between px-4 shrink-0"},le={class:"font-bold text-cyber-primary flex items-center gap-2"},ne={class:"text-xs bg-slate-900 px-2 py-1 rounded text-slate-300 font-mono"},ae={key:0,class:"text-center pointer-events-none"},se={class:"h-16 bg-slate-800 border-t border-slate-700 flex items-center justify-between px-4 shrink-0 gap-4"},re={class:"flex items-center gap-3"},ie={class:"flex-1 bg-cyber-panel border border-slate-700 rounded-xl shadow-lg flex flex-col min-w-[300px]"},de={class:"p-4 border-b border-slate-700"},ce={class:"font-bold text-white flex items-center gap-2"},ue={class:"p-4 space-y-4 overflow-y-auto flex-1"},pe={class:"space-y-3"},be={class:"flex-1 flex flex-col min-h-[200px]"},xe={class:"flex justify-between items-center mb-1"},fe=["value"],ve={__name:"StegSolve",setup(R){const k=f(null),I=f(!1),b=f(0);let c=null,x=null;const _=(l,e)=>{const n=[];for(let o=7;o>=0;o--)n.push({name:`${l} Plane ${o}`,func:(s,i,a,d)=>{const u=([s,i,a,d][e]>>o&1)===1?255:0;return[u,u,u,255]}});return n},B=[{name:"Normal Image",func:(l,e,n,o)=>[l,e,n,o]},{name:"Inverted",func:(l,e,n,o)=>[255-l,255-e,255-n,o]},..._("Red",0),..._("Green",1),..._("Blue",2),..._("Alpha",3)],N=z(()=>B[b.value].name),U=l=>S(l.dataTransfer.files[0]),V=l=>S(l.target.files[0]),S=l=>{if(!l)return;const e=new FileReader;e.onload=n=>{const o=new Image;o.onload=()=>{const s=k.value;x=s.getContext("2d",{willReadFrequently:!0}),s.width=o.width,s.height=o.height,x.drawImage(o,0,0),c=x.getImageData(0,0,s.width,s.height),I.value=!0,s.style.display="block",b.value=0,L()},o.src=n.target.result},e.readAsDataURL(l)},C=l=>{if(!I.value)return;let e=b.value+l;e>=B.length&&(e=0),e<0&&(e=B.length-1),b.value=e,L()},L=()=>{if(!c)return;const l=B[b.value],e=c.width,n=c.height,o=c.data,s=x.createImageData(e,n),i=s.data;if(b.value===0){x.putImageData(c,0,0);return}for(let a=0;a<o.length;a+=4){const[d,p,g,u]=l.func(o[a],o[a+1],o[a+2],o[a+3]);i[a]=d,i[a+1]=p,i[a+2]=g,i[a+3]=u}x.putImageData(s,0,0)},v=f({mode:"rgb",bitOrder:"lsb"}),D=f([]),A=f(""),G=()=>{if(!c)return;const l=c.data,{mode:e,bitOrder:n}=v.value,s={rgb:[0,1,2],bgr:[2,1,0],rgba:[0,1,2,3],r:[0],g:[1],b:[2],a:[3]}[e]||[0,1,2];let i=[];for(let r=0;r<l.length;r+=4)for(let T of s)i.push(l[r+T]&1);const a=[];let d=0,p=0;for(let r of i)n==="lsb"?d|=r<<p:d=d<<1|r,p++,p===8&&(a.push(d),d=0,p=0);D.value=a;let g="",u="";const E=Math.min(a.length,512);for(let r=0;r<E;r++)g+=a[r].toString(16).padStart(2,"0")+" ",u+=a[r]>=32&&a[r]<=126?String.fromCharCode(a[r]):".";A.value=`[HEX]:
${g}

[ASCII]:
${u}`},P=()=>{const l=new Uint8Array(D.value),e=new Blob([l],{type:"application/octet-stream"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="extracted.bin",o.click(),URL.revokeObjectURL(n)};return(l,e)=>(y(),w("div",Z,[t("div",ee,[t("div",te,[t("div",oe,[t("span",le,[m(h(H),{class:"w-5 h-5"}),e[6]||(e[6]=M(" 图像预览 ",-1))]),t("span",ne,X(N.value),1)]),t("div",{class:"flex-1 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] bg-slate-900 relative overflow-auto flex items-center justify-center p-4",onDragover:e[0]||(e[0]=$(()=>{},["prevent"])),onDrop:$(U,["prevent"])},[I.value?F("",!0):(y(),w("div",ae,[m(h(W),{class:"w-12 h-12 text-slate-600 mx-auto mb-2"}),e[7]||(e[7]=t("p",{class:"text-slate-500 text-sm"},"直接把图像拖到这里...",-1))])),t("canvas",{ref_key:"canvasRef",ref:k,class:"max-w-full shadow-2xl border border-slate-700 image-pixelated",style:{display:"none"}},null,512)],32),t("div",se,[t("button",{onClick:e[1]||(e[1]=n=>C(-1)),class:"btn-icon",title:"Previous Plane"},[m(h(J),{class:"w-5 h-5"})]),t("div",re,[t("input",{type:"file",ref:"fileInput",accept:"image/*",class:"hidden",onChange:V},null,544),t("button",{onClick:e[2]||(e[2]=n=>l.$refs.fileInput.click()),class:"bg-cyber-primary text-cyber-bg px-4 py-2 rounded-lg text-xs font-bold hover:bg-white transition shadow-lg shadow-cyber-primary/20"}," 选择图像 ")]),t("button",{onClick:e[3]||(e[3]=n=>C(1)),class:"btn-icon",title:"Next Plane"},[m(h(K),{class:"w-5 h-5"})])])])]),t("div",ie,[t("div",de,[t("h3",ce,[m(h(Y),{class:"w-5 h-5 text-cyber-accent"}),e[8]||(e[8]=M(" 数据提取 ",-1))]),e[9]||(e[9]=t("p",{class:"text-[10px] text-slate-500 mt-1"},"从通道中提取LSB数据",-1))]),t("div",ue,[t("div",pe,[t("div",null,[e[11]||(e[11]=t("label",{class:"text-[10px] uppercase text-slate-400 font-bold block mb-1"},"通道顺序",-1)),O(t("select",{"onUpdate:modelValue":e[4]||(e[4]=n=>v.value.mode=n),class:"w-full bg-slate-900 border border-slate-600 rounded px-2 py-1.5 text-xs text-white outline-none focus:border-cyber-accent"},[...e[10]||(e[10]=[Q('<optgroup label="标准" data-v-935471d5><option value="rgb" data-v-935471d5>RGB (默认)</option><option value="bgr" data-v-935471d5>BGR</option><option value="rgba" data-v-935471d5>RGBA</option></optgroup><optgroup label="单通道" data-v-935471d5><option value="r" data-v-935471d5>Red Only</option><option value="g" data-v-935471d5>Green Only</option><option value="b" data-v-935471d5>Blue Only</option><option value="a" data-v-935471d5>Alpha Only</option></optgroup>',2)])],512),[[j,v.value.mode]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"text-[10px] uppercase text-slate-400 font-bold block mb-1"},"Bit 顺序",-1)),O(t("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>v.value.bitOrder=n),class:"w-full bg-slate-900 border border-slate-600 rounded px-2 py-1.5 text-xs text-white outline-none focus:border-cyber-accent"},[...e[12]||(e[12]=[t("option",{value:"lsb"},"LSB First",-1),t("option",{value:"msb"},"MSB First",-1)])],512),[[j,v.value.bitOrder]])]),t("button",{onClick:G,class:"w-full bg-cyber-accent text-white py-2 rounded text-xs font-bold hover:bg-blue-600 transition"}," Extract Data ")]),t("div",be,[t("div",xe,[e[14]||(e[14]=t("span",{class:"text-[10px] font-bold text-slate-400"},"预览 (前 512 字节)",-1)),D.value.length?(y(),w("button",{key:0,onClick:P,class:"text-[10px] text-cyber-primary hover:underline"},"导出 .bin")):F("",!0)]),t("textarea",{readonly:"",value:A.value,class:"flex-1 w-full bg-black border border-slate-700 rounded p-2 font-mono text-[10px] text-green-400 resize-none outline-none leading-relaxed"},null,8,fe)])])])]))}},me=q(ve,[["__scopeId","data-v-935471d5"]]);export{me as default};
