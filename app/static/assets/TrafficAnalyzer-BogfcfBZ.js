import{c as a,a as e,o,_ as F,r as d,p as K,b as O,u as f,e as C,A as z,v as X,n as c,q as D,t as n,J as E,g as b,F as M,h as B,d as H}from"./index-CI3-vDyV.js";import{r as I}from"./LockOpenIcon-DuKIp2pq.js";function J(v,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"})])}function Z(v,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"})])}function G(v,i){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}const Q={class:"h-full flex flex-col gap-4"},W={class:"bg-cyber-panel border border-slate-700 rounded-xl p-4 shadow-lg flex flex-wrap gap-4 items-center justify-between"},Y={class:"flex-shrink-0"},ee={class:"relative group"},te={class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-5 py-2.5 rounded-lg transition-all font-bold text-sm shadow-blue-900/50 shadow-lg"},se={class:"flex-1 flex justify-center min-w-[300px]"},le={class:"flex items-center gap-4 bg-slate-900/60 px-5 py-2 rounded-xl border border-slate-700/50 shadow-inner"},oe={class:"flex items-center gap-3"},ae={class:"flex flex-col gap-0.5"},ne={class:"flex flex-col gap-0.5"},re={class:"flex flex-col gap-0.5"},de={class:"relative"},ie={class:"flex items-center gap-4 flex-shrink-0"},ce={class:"text-slate-500 text-xs font-mono text-right min-w-[80px]"},ue={key:0,class:"flex flex-col items-end leading-tight"},pe={class:"text-blue-400 font-bold text-sm"},xe={key:1},fe={class:"flex-1 overflow-auto custom-scrollbar"},be={class:"w-full text-xs font-mono border-collapse"},ve=["onClick"],ye=["title"],he={class:"px-3 py-2 text-right text-slate-500"},ge={key:0,class:"text-center py-10 text-slate-600 text-xs"},we={class:"flex-1 bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-lg bg-[#0d1117] min-w-0"},me={key:0,class:"flex flex-col h-full"},_e={class:"bg-slate-800/90 px-6 py-3 border-b border-slate-700 flex justify-between items-center backdrop-blur-sm z-20"},ke={class:"flex items-center gap-3"},Ce={class:"text-sm font-mono text-slate-400"},De={key:0,class:"bg-purple-900/50 text-purple-200 px-2 py-0.5 rounded text-xs font-bold border border-purple-700/50"},Pe={class:"text-xs text-slate-500 font-mono"},je={class:"flex-1 overflow-auto custom-scrollbar p-6 flex flex-col gap-6 relative"},Se={key:0,class:"absolute inset-0 bg-[#0d1117]/80 flex flex-col items-center justify-center z-10"},Te={class:"flex items-center gap-2 px-1 opacity-70"},ze={class:"text-[10px] font-mono text-slate-500 truncate max-w-[300px]"},Ee={class:"flex items-center justify-between px-3 py-1.5 bg-black/20 border-b border-white/5"},Me={class:"text-[10px] text-slate-500 font-mono flex gap-2"},Be=["onClick","disabled"],Ae={key:1,class:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"},$e={key:0,class:"bg-blue-500/5 border-b border-white/5 p-3 animate-fade-in"},Le={class:"flex items-center gap-2 mb-2"},Ne={class:"font-mono text-xs text-slate-300 whitespace-pre-wrap break-all leading-relaxed bg-black/30 p-2 rounded border border-white/10 max-h-[400px] overflow-auto custom-scrollbar"},Re={class:"p-3 relative"},Ve={key:0,class:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-[#1c2128] to-transparent flex items-end justify-center pb-1"},Ue=["onClick"],qe={key:2,class:"flex flex-col items-center justify-center h-full text-slate-600 gap-2"},Fe={key:1,class:"flex-1 flex flex-col items-center justify-center text-slate-600 gap-4"},Ke={__name:"TrafficAnalyzer",setup(v){const i=d([]),u=d(null),y=d(!1),h=d(!1),x=d([]),g=d("godzilla"),w=d("jsp"),m=d("key"),p=d(!0),_=K(()=>p.value?i.value.filter(l=>l.method!=="TCP"):i.value),k=d(null),P=d(33.33),j=d(!1),A=()=>{j.value=!0,document.addEventListener("mousemove",S),document.addEventListener("mouseup",T),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},S=l=>{if(!k.value)return;const t=k.value.getBoundingClientRect();let r=(l.clientX-t.left)/t.width*100;r<30&&(r=30),r>70&&(r=70),P.value=r},T=()=>{j.value=!1,document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",T),document.body.style.cursor="",document.body.style.userSelect=""},$=async l=>{const t=l.target.files[0];if(!t)return;y.value=!0,i.value=[],u.value=null;const s=new FormData;s.append("file",t);try{const r=await fetch("/api/traffic/analyze",{method:"POST",body:s});r.ok&&(i.value=await r.json())}finally{y.value=!1}},L=async l=>{u.value=l,x.value=[],h.value=!0;try{const t=await fetch(`/api/traffic/stream_messages/${l.stream_id}`);if(t.ok){const s=await t.json();x.value=s.map(r=>({...r,isExpanded:!1,isDecrypting:!1,decryptedData:null}))}}finally{h.value=!1}},N=l=>{try{return l?atob(l):""}catch{return"[Binary Content]"}},R=async l=>{l.isDecrypting=!0,l.decryptedData=null;try{const s=await(await fetch("/api/traffic/decrypt_shell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload_b64:l.raw_b64,tool:g.value,script_type:w.value,secret_key:m.value})})).json();s.status==="success"?(l.decryptedData=s.content,l.isExpanded=!1):l.decryptedData=[]}catch(t){console.error(t)}finally{l.isDecrypting=!1}},V=l=>({success:"bg-green-400",info:"bg-blue-400",warning:"bg-yellow-400",neutral:"bg-slate-400"})[l]||"bg-slate-400",U=l=>({success:"text-green-400",info:"text-blue-400",warning:"text-yellow-400",neutral:"text-slate-400"})[l]||"text-slate-400";return(l,t)=>(o(),a("div",Q,[e("div",W,[e("div",Y,[e("div",ee,[e("button",te,[O(f(J),{class:"w-5 h-5"}),t[4]||(t[4]=e("span",null,"Upload PCAP",-1))]),e("input",{type:"file",accept:".pcap,.pcapng",onChange:$,class:"absolute inset-0 opacity-0 cursor-pointer"},null,32)])]),e("div",se,[e("div",le,[e("div",oe,[e("div",ae,[t[6]||(t[6]=e("label",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-wider pl-1"},"Tool",-1)),C(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),class:"bg-slate-800 border border-slate-600 text-white text-xs rounded px-2 py-1.5 focus:border-blue-500 outline-none w-24"},[...t[5]||(t[5]=[e("option",{value:"godzilla"},"Godzilla",-1),e("option",{value:"behinder"},"Behinder",-1)])],512),[[z,g.value]])]),e("div",ne,[t[8]||(t[8]=e("label",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-wider pl-1"},"Script",-1)),C(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>w.value=s),class:"bg-slate-800 border border-slate-600 text-white text-xs rounded px-2 py-1.5 focus:border-blue-500 outline-none w-20"},[...t[7]||(t[7]=[e("option",{value:"jsp"},"JSP",-1),e("option",{value:"php"},"PHP",-1),e("option",{value:"aspx"},"ASPX",-1)])],512),[[z,w.value]])])]),t[10]||(t[10]=e("div",{class:"w-[1px] h-8 bg-slate-700/80"},null,-1)),e("div",re,[t[9]||(t[9]=e("label",{class:"text-[10px] text-yellow-600/80 font-bold uppercase tracking-wider pl-1"},"Key / Password",-1)),e("div",de,[C(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),type:"text",placeholder:"Enter Key...",class:"bg-slate-800 border border-slate-600 text-yellow-400 text-xs rounded px-3 py-1.5 focus:border-yellow-500 outline-none w-48 font-mono shadow-sm"},null,512),[[X,m.value,void 0,{trim:!0}]])])])])]),e("div",ie,[e("button",{onClick:t[3]||(t[3]=s=>p.value=!p.value),class:c(["flex items-center gap-2 px-3 py-2 rounded-lg border transition-all text-xs font-bold shadow-sm",p.value?"bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700 hover:text-slate-200":"bg-indigo-900/40 text-indigo-300 border-indigo-500/50 hover:bg-indigo-900/60"])},[p.value?(o(),D(f(Z),{key:0,class:"w-4 h-4"})):(o(),D(f(G),{key:1,class:"w-4 h-4"})),e("span",null,n(p.value?"TCP Hidden":"Show TCP"),1)],2),t[12]||(t[12]=e("div",{class:"h-8 w-[1px] bg-slate-700"},null,-1)),e("div",ce,[i.value.length?(o(),a("div",ue,[e("span",pe,n(_.value.length),1),t[11]||(t[11]=e("span",{class:"text-[10px] opacity-70"},"Streams",-1))])):(o(),a("span",xe,"No Data"))])])]),e("div",{class:"flex-1 flex min-h-0 select-none",ref_key:"containerRef",ref:k},[e("div",{class:"bg-cyber-panel border border-slate-700 rounded-xl flex flex-col overflow-hidden shadow-lg transition-none",style:E({width:`${P.value}%`})},[t[14]||(t[14]=e("div",{class:"bg-slate-800/80 px-4 py-3 border-b border-slate-700 flex justify-between items-center"},[e("span",{class:"font-bold text-slate-200 text-sm"},"Conversations"),e("span",{class:"text-[10px] text-slate-500 uppercase tracking-wider font-mono"},"List")],-1)),e("div",fe,[e("table",be,[t[13]||(t[13]=e("thead",{class:"sticky top-0 bg-slate-900/95 text-slate-400 z-10 shadow-sm"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left w-16"},"Type"),e("th",{class:"px-3 py-2 text-left"},"URI / Info"),e("th",{class:"px-3 py-2 text-right w-20"},"Size")])],-1)),e("tbody",null,[(o(!0),a(M,null,B(_.value,s=>(o(),a("tr",{key:s.id,onClick:r=>L(s),class:c(["cursor-pointer border-b border-slate-800/50 transition-colors h-10",u.value?.id===s.id?"bg-blue-900/20 border-l-2 border-l-blue-400":"hover:bg-slate-800/30 border-l-2 border-l-transparent"])},[e("td",{class:c(["px-3 py-2 font-bold",{"text-blue-400":s.method==="POST","text-green-400":s.method==="GET","text-purple-400":s.method==="RESP","text-slate-500":s.method==="TCP"}])},n(s.method),3),e("td",{class:"px-3 py-2 text-slate-300 truncate max-w-[140px]",title:s.uri},n(s.uri||"-"),9,ye),e("td",he,n((s.payload_len/1024).toFixed(1))+" KB",1)],10,ve))),128))])]),_.value.length===0&&!y.value?(o(),a("div",ge,n(i.value.length>0&&p.value?"TCP streams hidden.":"No streams found."),1)):b("",!0)])],4),e("div",{class:"w-5 flex flex-col items-center justify-center cursor-col-resize hover:bg-slate-800/0 group z-50 relative flex-shrink-0",onMousedown:A},[...t[15]||(t[15]=[e("div",{class:"h-full w-[1px] border-l border-dashed border-slate-700 group-hover:border-blue-500/50 transition-colors duration-300 my-2"},null,-1)])],32),e("div",we,[u.value?(o(),a("div",me,[e("div",_e,[e("div",ke,[e("span",Ce,"Stream #"+n(u.value.id),1),u.value.shell_type!=="unknown"?(o(),a("span",De,n(u.value.shell_type.toUpperCase()),1)):b("",!0)]),e("div",Pe,n(x.value.length)+" Message(s) ",1)]),e("div",je,[h.value?(o(),a("div",Se,[...t[16]||(t[16]=[e("div",{class:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mb-2"},null,-1),e("span",{class:"text-xs text-slate-400"},"Parsing stream content...",-1)])])):x.value.length>0?(o(!0),a(M,{key:1},B(x.value,(s,r)=>(o(),a("div",{key:s.seq,class:c(["flex flex-col gap-1 max-w-full animate-fade-in",s.type==="req"?"items-start":"items-end"]),style:E({animationDelay:`${r*.05}s`})},[e("div",Te,[e("span",{class:c(["text-[9px] font-bold uppercase tracking-wider px-1.5 py-0.5 rounded",s.type==="req"?"bg-blue-900 text-blue-300":"bg-green-900 text-green-300"])},n(s.type==="req"?"REQ":"RESP"),3),e("span",ze,n(s.header_summary),1)]),e("div",{class:c(["w-full max-w-[95%] rounded-lg border shadow-lg overflow-hidden transition-all duration-300 group",s.type==="req"?"bg-[#1c2128] border-blue-900/30":"bg-[#161b22] border-green-900/30"])},[e("div",Ee,[e("div",Me,[e("span",null,n(s.content_len)+" Bytes",1)]),e("button",{onClick:q=>R(s),disabled:s.isDecrypting,class:"flex items-center gap-1.5 px-2 py-1 rounded hover:bg-white/10 text-slate-400 hover:text-white text-[10px] font-bold transition-all disabled:opacity-50"},[s.isDecrypting?(o(),a("div",Ae)):(o(),D(f(I),{key:0,class:"w-3 h-3"})),H(" "+n(s.decryptedData?"Decrypt Again":"Decrypt Payload"),1)],8,Be)]),s.decryptedData&&s.decryptedData.length>0?(o(),a("div",$e,[e("div",Le,[e("div",{class:c(["w-1.5 h-1.5 rounded-full",V(s.decryptedData[0]?.type)])},null,2),e("span",{class:c(["text-xs font-bold",U(s.decryptedData[0]?.type)])},n(s.decryptedData[0]?.title),3)]),e("div",Ne,n(s.decryptedData[0]?.content),1)])):b("",!0),e("div",Re,[e("div",{class:c(["font-mono text-[10px] text-slate-500 whitespace-pre-wrap break-all leading-relaxed transition-all duration-300",s.isExpanded?"max-h-none":"max-h-[120px] overflow-hidden opacity-80"])},n(N(s.raw_b64)),3),!s.isExpanded&&s.content_len>250?(o(),a("div",Ve,[e("button",{onClick:q=>s.isExpanded=!0,class:"text-[9px] text-blue-400 hover:text-blue-300 bg-slate-900/80 px-2 py-0.5 rounded border border-slate-700"},"Show All",8,Ue)])):b("",!0)])],2)],6))),128)):(o(),a("div",qe,[...t[17]||(t[17]=[e("span",{class:"text-xs"},"No recognizable content found.",-1)])]))])])):(o(),a("div",Fe,[...t[18]||(t[18]=[e("div",{class:"w-16 h-16 rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700"},[e("span",{class:"text-2xl opacity-20"},"Select")],-1),e("p",{class:"text-sm font-medium"},"Select a stream from the left list",-1)])]))])],512)]))}},He=F(Ke,[["__scopeId","data-v-81fe7e12"]]);export{He as default};
